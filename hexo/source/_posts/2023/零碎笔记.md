---
title: 零碎笔记
abbrlink: 36605
date: 2023-02-08 10:33:26
categories:
  - 笔记
tags:
comments: true
license: true
cc_license: true
---



## GIT

### 清理仓库历史
``` bash
# 切换到一个脱离主分支的另外一条全新主分支，不用太在意叫什么，因为后面还会修改分支名称
git checkout --orphan latest_branch
# 暂存所有改动过的文件，内容为当前旧分支的最新版本所有文件
git add -A
#提交更改
git commit -am "commit message"
#删除原始主分支
git branch -D main
#将当前分支重命名为 main
git branch -m main
#最后，强制更新您的存储库
git push -f origin main

```

### [从仓库的历史记录中删除文件](https://docs.github.com/zh/repositories/working-with-files/managing-large-files/about-large-files-on-github#removing-files-from-a-repositorys-history)


## 邮件测试

### Python
```python
import smtplib
smtpObj = smtplib.SMTP()
smtpObj.connect("mail.nwpu.edu.cn",25)
smtpObj.login("mapengfei@mail.nwpu.edu.cn","a13566946986")
smtpObj.sendmail("mapengfei@mail.nwpu.edu.cn","499908174@qq.com","dfasdfa")
smtpObj.quit()


smtpObj = smtplib.SMTP_SSL("smtp.nwpu.edu.cn")
smtpObj.login("mapengfei@mail.nwpu.edu.cn","a13566946986")
smtpObj.sendmail("mapengfei@mail.nwpu.edu.cn","499908174@qq.com","dfasdfa")
smtpObj.quit()

import smtplib
smtpObj = smtplib.SMTP_SSL("smtp.qq.com")
smtpObj.login("499908174@qq.com","zzokkzruycbobicd")
smtpObj.sendmail("499908174@qq.com","mapengfei@mail.nwpu.edu.cn","ddddfasdfa")
smtpObj.quit()

import smtplib
smtpObj = smtplib.SMTP_SSL("smtp.163.com",465)
smtpObj.login("merryjingle@163.com","OCDVFOFNDTXLIXGN")
smtpObj.sendmail("merryjingle@163.com","499908174@qq.com","ddddfasdfa")
smtpObj.quit()
```

### swaks

``` bash
swaks --to 499908174@qq.com --from mapengfei@mail.nwpu.edu.cn --server smtp.nwpu.edu.cn --auth login --auth-user mapengfei@mail.nwpu.edu.cn  -p 25

swaks --to mapengfei@mail.nwpu.edu.cn --from 499908174@qq.com --server smtp.qq.com --auth plain --auth-user 499908174@qq.com  -tls -p 587

swaks --to 499908174@qq.com --from merryjingle@163.com --server smtp.163.com --auth login --auth-user merryjingle@163.com -p 25
```


## Vercel

### [反向代理](https://blog.csdn.net/qq_39010320/article/details/119923538)


## 表情包制作
#### 表情包下载
1. [Microsoft animated fluent emojis](https://github.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis)

#### png格式转gif格式
artalk中，png格式的动图只能显示静态，需要转换成gif格式。


``` python
# pip install pillow -i https://pypi.douban.com/simple
from PIL import Image
import os

# 源文件
origin_directory = '.'
output_directory = './compressed'
max_width = 1080

#获取文件夹里面的图片
path_list=[origin_directory + "/" + i for i in os.listdir(origin_directory)]

def reduce_image_quality(infile, mb=102400, step=3, quality=80):
    """不改变图片尺寸压缩到指定大小
    :param infile: 压缩源文件
    :param mb: 压缩目标(B)默认100K
    :param step: 每次调整的压缩比率
    :param quality: 初始压缩比率
    """
    outfile = 'temp.webp'
    o_size = os.path.getsize(infile)
    if o_size < mb:
        return
    else :
        while o_size > mb:
            print(o_size, quality)
            im = Image.open(infile)
            im.save(outfile, quality=quality)
            if quality - step < 0:
                break
            quality -= step
            o_size = os.path.getsize(outfile)
        im = Image.open(infile)
        im.save(infile, quality=quality)    


#循环图片路径，依次对图片进行压缩
for file_input in path_list:
    file   = file_input.split("/")[-1]
    filename, format_in = (file.split(".")[0], file.split(".")[-1])
    format_out = 'webp'
    file_output = '{directory:s}/{filename:s}.{format_out}'.format(directory=output_directory,filename=filename,format_out=format_out)
    print(file_output)
    if format_in not in set(['png']):
        continue
    im = Image.open(file_input)
    (x, y) = im.size            # 读取图片尺寸（像素）
    if x < max_width:
        out = im
    else :
        x_1 = max_width         # 定义缩小后的标准宽度
        y_1 = int(y * x_1 / x)  # 计算缩小后的高度
        out = im.resize((x_1, y_1), Image.Resampling.LANCZOS)  # 改变尺寸，保持图片高品质
    out.save(file_output)
    reduce_image_quality(file_output)
```