---
title: 浸没边界有限元方法的一种无条件能量稳定数值格式
categories: []
tags: []
katex: true
comments: false
license: true
cc_license: false
abbrlink: 47559
date: 2022-12-06 16:37:00
---

简介：

<!-- more -->
### 1 引言 Introduction

给出一种数值格式，证明它无条件能量稳定，然后再设计求解算法，最后给出数值结果。

### 2 连续方程 Continuous equations 

### 3 时间离散 Temporal discretization

不管是经典的浸没边界法，还是它的拓展模型，在数值格式的稳定性方面，时间离散格式比空间离散格式更重要，本文所讨论的模型也不例外。因此，我们首先将连续运动方程按时间变量进行离散，得到一个空间连续、时间离散的系统。公式 (1-5) 是本文使用的时间离散格式，它的特点是固体位移方程 (5) 采用了隐式离散。此外，插值算子和延拓算子中的固体位移变量采用了显式离散，由此产生的迟滞效应并不会影响数值格式的稳定性。
$$
\begin{equation}
            \rho\left(\frac{\mathbf{u}_{n+1}-{\mathbf{u}_{n}}}{\Delta t}+{\color{red}\mathbf{u}_{n}} \cdot \nabla \mathbf{u}_{n+1}\right)-\mu \Delta \mathbf{u}_{n+1}+\nabla p_{n+1} = \mathbf{f}_{n+1},
        \end{equation}
$$
$$
\begin{equation}
            \nabla \cdot \mathbf{u}_{n+1} =0, 
\end{equation}
$$
$$
\begin{equation}
            \int_{B_{r}} \mathbf{F}_{n+1} \cdot \mathbf{V} \mathrm d \mathbf{x} =-\int_{B_{r}} \mathbb{P}_{n+1}: \nabla \mathbf{V} \mathrm d \mathbf{X},
        \end{equation}
$$
$$
        \begin{equation}
            \mathbf{f}\left(\mathbf{x}, t_{n+1}\right) =\int_{B_r} \mathbf{F}\left(\mathcal{X}_{n+1}\right) \delta\left(\mathbf{x}-{\color{red}\mathcal{X}_{n}}\right) \mathrm d \mathbf{X} ,
        \end{equation}
$$
$$
\begin{equation}
            \frac{\mathcal{X}\left(\mathbf{X}, t_{n+1}\right) - \mathcal{X}\left(\mathbf{X}, t_{n}\right)}{\Delta t} =  \int_{\Omega} {\color{red}\mathbf{u}\left(\mathbf{x}, t_{n+1}\right)} \delta\left(\mathbf{x}-{\color{red}\mathcal{X}_{n}}\right) \mathrm d \mathbf{x}.
        \end{equation}
$$



### 4 无条件稳定 Unconditionally stable

#### 4.1 半离散格式的无条件能量稳定证明

我们将为流固耦合系统定义一个适当的能量函数，并证明在满足某些条件的情况下，它是一个关于时间非增的函数，因此它是一个有界函数。这就证明了数值格式 (1-5) 是无条件稳定的。

令$(\mathbf{v},\mathbf{w})_{\Omega}=\int_{\Omega}\mathbf{v}\cdot\mathbf{w}\;\mathrm{d}\mathbf{x}$表示$L^2(\Omega)$的内积，$\|\cdot\|_{L^2(\Omega)}$表示$L^2(\Omega)$的范数，$\frac{\rho}{2}\|\mathbf{u}\|_{L^2(\Omega)}^2$为流固耦合系统的总动能。令$(\mathbf{V},\mathbf{W})_{B_r}=\int_{B_r}\mathbf{V}\cdot\mathbf{W}\;\mathrm{d}\mathbf{X}$表示$L^2(B_r)$的内积，$E(\mathcal{X})=\int_{B_r}W(\mathcal{X})\;\mathrm{d}\mathbf{X}$表示固体的弹性势能。流固耦合系统的总能量是流固耦合系统的总动能和固体的弹性势能之和，是一个关于$\mathbf{u}$和$\mathcal{X}$的函数，可以表示成

$$
R(\mathbf{u},\mathcal{X})=\frac{\rho}{2}\|\mathbf{u}\|_{L^2(\Omega)}^2+E(\mathcal{X})
$$

#### 内积形式

将等式(1)和 $\mathbf{u}_{n+1}$ 在 $\Omega$ 上做内积，~~将等式(2)和 $\mathbf{p}_{n+1}$ 在 $\Omega$ 上做内积（这一条好像没有必要），~~将 $\mathbf{V} = \frac{1}{\Delta t}(\mathcal{X}_{n+1}-\mathcal{X}_{n})$ 代入等式(3)，将等式(4)和 $\mathbf{u}_{n+1}$ 在 $\Omega$ 上做内积，将等式(5)和 $-\mathbf{F}_{n+1}$ 在 $B_r$ 上做内积，我们可以得到方程组(7-11)。
$$
\begin{equation}
        \begin{aligned}
            \frac{\rho}{\Delta t}\left(\mathbf{u}_{n+1}-\mathbf{u}_n,\mathbf{u}_{n+1}\right)_{\Omega}&+\left(\mathbf{u}_n\cdot\nabla\mathbf{u}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}
            -\mu\left(\Delta\mathbf{u}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}\\
&-\left(\nabla p_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}=\left(\mathbf{f}_{n+1}\cdot\mathbf{u}_{n+1}\right)_{\Omega}
        \end{aligned}
    \end{equation}
$$
$$
    \begin{equation}
    \left(p_{n+1},\nabla\cdot\mathbf{u}_{n+1}\right)=0
    \end{equation}
$$
$$
\begin{equation}
        \frac{1}{\Delta t}\left(\mathbf{F}_{n+1},\mathcal{X}_{n+1}-\mathcal{X}_{n}\right)_{B_r}=-\frac{1}{\Delta t}(\mathbb{P}_{n+1},\nabla(\mathcal{X}_{n+1}-\mathcal{X}_{n}))_{B_r}
    \end{equation}
$$

$$
\begin{equation} \left(\mathbf{f}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}=\int_{\Omega}\int_{B_r}\mathbf{F}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{X}\cdot\mathbf{u}_{n+1}\;\mathrm{d}\mathbf{x}
    \end{equation}
$$

$$
\begin{equation}
        -\frac{1}{\Delta t}\left((\mathcal{X}_{n+1}-\mathcal{X}_{n}),\mathbf{F}_{n+1}\right)_{B_r}=-\int_{B_r}\int_\Omega\mathbf{u}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{x}\cdot\mathbf{F}_{n+1}\;\mathrm{d}\mathbf{X}
\end{equation}
$$

不失一般性，我们假设速度满足边界条件$\mathbf{u}|_{\partial \Omega}=0$或$\frac{\partial\mathbf{u}}{\partial \mathbf{n}}|_{\partial\Omega}=0$，根据无散度条件$\nabla\cdot\mathbf{u}_{n+1}=0$，我们可以得出 $\left(\mathbf{u}_n\cdot\nabla\mathbf{u}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}=0$，且$\left(\nabla p_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}=0$。此外，我们假设应变能函数满足以下条件：

令$\mathbb{H}$为对 $W$ 二阶求导得到的四阶张量：

$$
        \mathbb{H}_{\alpha i \beta j}:=\frac{\partial^2 W}{\partial \mathbb{F}_{\alpha i} \partial \mathbb{F}_{\beta j}} \text {. }
$$
假设存在$\kappa_{\min },\kappa_{\max }>0$使得
$$
        \kappa_{\min } \mathbb{E}^2 \leqslant \mathbb{E}: \mathbb{H}: \mathbb{E} \leqslant \kappa_{\max } \mathbb{E}^2
$$
对任意二阶张量$\mathbb{E}$成立。其中， $\mathbb{E}^2=\mathbb{E}: \mathbb{E}, \quad \mathbb{E}: \mathbb{H}: \mathbb{E}=\mathbb{E}_{\alpha i} \mathbb{H}_{\alpha i \beta j} \mathbb{E}_{\beta j}$。

对于不可压缩材料，这是一个合理的假设，据此可以得出
$$
\frac{1}{\Delta t}\left(E\left(\mathcal{X}^{n+1}\right)-E\left(\mathcal{X}^n\right)\right)\le\left(\mathbb{P}\left(\mathbb{F}^{n+1}\right), \frac{\mathbb{F}^{n+1}-\mathbb{F}^n}{\Delta t}\right)_{\mathcal{B}}
$$
对于等式(7)中的第一项，我们可以进行如下推导：
$$
\begin{equation}
        (\mathbf{u}_{n+1}-\mathbf{u}_n,\mathbf{u}_{n+1})=\frac{1}{2}\|\mathbf{u}_{n+1}-\mathbf{u}_n\|_{\Omega}^2+\frac{1}{2}(\|\mathbf{u}_{n+1}\|_{\Omega}^2-\|\mathbf{u}_{n}\|_{\Omega}^2)
    \end{equation}
$$

而对于等式(10)和(11)中插值算子和延拓算子，我们可以通过交换积分顺序得到等式(16)
$$
\begin{equation}
        \int_{\Omega}\int_{B_r}\mathbf{F}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{X}\cdot\mathbf{u}_{n+1}\;\mathrm{d}\mathbf{x} = \int_{B_r}\int_\Omega\mathbf{u}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{x}\cdot\mathbf{F}_{n+1}\;\mathrm{d}\mathbf{X}
    \end{equation}
$$

最后，将(15)代入(7)，将(16)代入(10)，再将(7)(9)(10)(11)式相加，可以得到等式
$$
\begin{equation}
        \frac{\rho}{2\Delta t}\left(\|\mathbf{u}_{n+1}\|^2-\|\mathbf{u}_{n}\|^2\right)+\frac{1}{\Delta t}\left(E(\mathcal{X}^{n+1})-E(\mathcal{X}^n)\right)=\mu\left(\Delta\mathbf{u}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}-\frac{\rho}{2\Delta t}(\|\mathbf{u}_{n+1}\|_{\Omega}^2-\|\mathbf{u}_{n}\|_{\Omega}^2)
\end{equation}
$$

由Laplace算子的负定性可以得出
$$
\begin{equation}
        \frac{\rho}{2\Delta t}\left(\|\mathbf{u}_{n+1}\|^2-\|\mathbf{u}_{n}\|^2\right)+\frac{1}{\Delta t}\left(E(\mathcal{X}^{n+1})-E(\mathcal{X}^n)\right)\le0
    \end{equation}
$$
因此方程组(1-5)求解出来的$\mathbf{u}$和$\mathcal{X}$满足不等式
$$
R(\mathbf{u},\mathcal{X})_{n+1}-R(\mathbf{u},\mathcal{X})_{n}\le0
$$

因此半离散格式是无条件能量稳定的。在$\mathbf{u}_{n+1}$和$\mathcal{X}_{n+1}$可解的前提下，取任意大的时间步长，系统都是稳定的。

#### 4.2 全离散格式的稳定性证明

对于全离散格式，我们不仅要考虑系统的稳定性，还要考虑求解效率。方程组(1-5)是非线性方程组，在求解过程中，存在求解方程组(1-2)的子步骤，即需要求解NS方程组。在求解NS方程时，速度和压强$(\mathbf{u}_{n+1},p_{n+1})$作为未知量可以整体求解，此方法得到的全离散格式仍是无条件能量稳定的，但这是一个鞍点问题，拥有非正定的、病态的系数矩阵，并不容易求解。投影方法可以将原方程转换成一个Poisson方程和一个类Poisson方程，使得我们可以使用具有最优计算复杂度且无需组装系数矩阵的几何多重网格方法求解，最后的求解器将具有非常高的效率。与整体求解有区别，投影方法先求一个中间速度$\mathbf{u}_*$，再求解压强$p_{n+1}$，最后求解速度$\mathbf{u}_{n+1}$，对流项的时间离散只能采用$\mathbf{u}_n\cdot\nabla\mathbf{u}_n$或者$\mathbf{u}_n\cdot\nabla\mathbf{u}_*$，无法采用$\mathbf{u}_n\cdot\nabla\mathbf{u}_{n+1}$，因此无法得出无条件能量稳定的结论。

对此我们做出了取舍。此前有大量研究表明，NS方程中的对流项，在浸没边界法中，对稳定性的影响不大，流固耦合系统对时间步长的限制远比对流项严格。我们会先去掉NS方程中的对流项，暂时把流体当成蠕动流，分析其全离散格式的稳定性，在后面章节的数值算例中再引入对流项，以表明对流项对稳定性影响确实不大。~~在浸没边界法中，对流项一直以来都是影响稳定性的次要因素，Newren论文中是这样说的：因为对流项对稳定性影响不大，我们只考虑没有对流项的Stokes方程。Boffi的论文中是这样说的：假设我们能精确估计出对流项$\mathbf{u}_n\cdot\nabla\mathbf{u}_{n+1}$。因此我觉得我们这里暂时不考虑是合理的。~~

暂时先不考虑对流项，方程组(19-24)为采用了投影方法的全离散格式，背景区域的空间离散采用了二阶差分格式，固体区域的离散采用了一阶有限元方法。


$$
\begin{equation}
\frac{\rho}{\Delta t}\left(\mathbf{u}_{*}-{\mathbf{u}_{n}}\right)-\mu \Delta_h \mathbf{u}_{*} = \mathbf{f}_{n+1},
\end{equation}
$$
$$
\begin{equation}
\Delta^h p_{n+1}=\frac{1}{\Delta t} \nabla^h \cdot \mathbf{u}^*
\end{equation}
$$
$$
\begin{equation}
\mathbf{u}^{n+1}=\mathbf{u}^*-\Delta t \nabla^h p_{n+1}
\end{equation}
$$
$$
\begin{equation}
            \int_{B_{h}} \mathbf{F}_{h,n+1} \cdot \mathbf{V}_h \mathrm d \mathbf{x} =\int_{B_h} \mathbb{P}_{h,n+1}: \nabla \mathbf{V}_h \mathrm d \mathbf{X},
        \end{equation}
$$
$$
\begin{equation}
            \mathbf{f}\left(\mathbf{x}, t_{n+1}\right) =\int_{B_r} \mathbf{F}_{h,n+1} \delta\left(\mathbf{x}-{\color{red}\mathcal{X}_{h,n}}\right) \mathrm d \mathbf{X} ,
        \end{equation}
$$
$$
\begin{equation}
            \frac{\mathcal{X}_{h,n+1} - \mathcal{X}_{h,n}}{\Delta t} =  \int_{\Omega} {\color{red}\mathbf{u}_{n+1}} \delta\left(\mathbf{x}-{\color{red}\mathcal{X}_{h,n}}\right) \mathrm d \mathbf{x}.
        \end{equation}
$$

#### 内积形式

令$\Omega_h$为离散后的背景区域。不失一般性，我们先考虑二维情况的均匀网格剖分，$i,j$为网格节点，定义内积为$(\mathbf{v},\mathbf{w})_{\Omega_h}=\sum_{i j} \mathbf{v}_{i j} \cdot \mathbf{w}_{i j} h^2$，令$B_h$为固体网格，定义内积为$(\mathbf{V},\mathbf{W})_{B_h}=\int_{B_h}\mathbf{V}\cdot\mathbf{W}\mathrm{d}\mathbf{x}$。类似半连续问题，定义系统能量为
$$
R_h(\mathbf{u}(\mathbf{x},t),\mathcal{X}_h(\mathbf{X},t))=
$$
我们要证明系统能量是关于时间的单调递减函数。将等式(20)和 $\mathbf{u}_{n+1}$ 在 $\Omega_h$ 上做内积，将等式(22)和 $\mathbf{u}_{n+1}$ 在 $\Omega_h$ 上做内积，令 $\mathbf{V}_h = \frac{1}{\Delta t}(\mathcal{X}_{h,n+1}-\mathcal{X}_{h,n})$ 代入等式(23)，将等式(24)和 $\mathbf{u}_{n+1}$ 在 $\Omega_h$ 上做内积，将等式(25)和 $-\mathbf{F}_{h,n+1}$ 在 $B_h$ 上做内积，我们可以得到方程组(27-31)。
$$
\begin{equation}
        \begin{aligned}
            \frac{\rho}{\Delta t}\left(\mathbf{u}_{*}-\mathbf{u}_n,\mathbf{u}_{n+1}\right)_{\Omega_h}
            -\mu\left(\Delta\mathbf{u}_{*},\mathbf{u}_{n+1}\right)_{\Omega_h}=\left(\mathbf{f}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega_h}
        \end{aligned}
    \end{equation}
$$

$$
\begin{equation}
\left(\mathbf{u}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega_h}=(\mathbf{u}_*-\Delta t \nabla^h p_{n+1},\mathbf{u}_{n+1})_{\Omega_h}
    \end{equation}
$$

$$
\begin{equation}
        \frac{1}{\Delta t}\left(\mathbf{F}_{h,n+1},\mathcal{X}_{h,n+1}-\mathcal{X}_{h,n}\right)_{B_h}=-(\mathbb{P}_{h,n+1},\nabla(\mathcal{X}_{h,n+1}-\mathcal{X}_{h,n}))_{B_h}
    \end{equation}
$$

$$
\begin{equation} \left(\mathbf{f}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega_h}=\left(\int_{B_r}\mathbf{F}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{X},\mathbf{u}_{n+1}\right)_{\Omega_h}
    \end{equation}
$$

$$
\begin{equation}
        -\frac{1}{\Delta t}\left((\mathcal{X}_{n+1}-\mathcal{X}_{n}),\mathbf{F}_{n+1}\right)_{B_h}=-\left(\int_\Omega\mathbf{u}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{x},\mathbf{F}_{n+1}\right)_{B_h}
\end{equation}
$$

除了前面假设的边界条件，我们还需假设离散算子$\nabla^h$和$\Delta^h$满足可交换性，由此可得离散的无散度向量场与离散的梯度场的内积为零。$\left(\mathbf{u},\nabla^h p\right)_{\Omega_h}=0$。假设应变能函数也满足前文所述假设。插值算子和延拓算子在空间离散后不一定满足对偶性，我们假设插值算子和延拓算子满足不等式(32)。
$$
\left(\int_{B_r}\mathbf{F}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{X},\mathbf{u}_{n+1}\right)_{\Omega_h}\le\left(\int_\Omega\mathbf{u}_{n+1}\delta(\mathbf{x}-\mathcal{X}_{n})\;\mathrm{d}\mathbf{x},\mathbf{F}_{n+1}\right)_{B_h}
$$
最后，(19)代入(24)消去$\mathbf{u}_*$，其他步骤和半离散格式类似，最后我们能得到不等式
$$
\begin{equation}
        \frac{\rho}{2\Delta t}\left(\|\mathbf{u}_{n+1}\|_{\Omega_h}^2-\|\mathbf{u}_{n}\|_{\Omega_h}^2\right)+\frac{1}{\Delta t}\left(E(\mathcal{X}^{n+1})-E(\mathcal{X}^n)\right)<\mu\left(\Delta\mathbf{u}_{n+1},\mathbf{u}_{n+1}\right)_{\Omega}-\frac{\rho}{2\Delta t}(\|\mathbf{u}_{n+1}\|_{\Omega_h}^2-\|\mathbf{u}_{n}\|_{\Omega_h}^2)
\end{equation}
$$
从而可以得到
$$
R_h(\mathbf{u},\mathcal{X})_{n+1}-R_h(\mathbf{u},\mathcal{X})_{n}\le0
$$

因此系统的能量是非增的。

#### 4.2 插值算子和延拓算子

插值算子和延拓算子应当满足不等式(32)，还应能够避免流固耦合计算过程中出现流体的流线穿透固体的现象，我们参考了Boyce的论文。插值算子采用高斯积分法计算
$$
\mathbf{f}_{i, j}=\sum_{k=1}^{N_B} \sum_{l=1}^{N_G} \mathbf{F}\left(\mathbf{X}_{k l}, t\right) \delta_h\left(\mathbf{x}_{i, j}-\mathcal{X}\left(\mathbf{X}_{k l}, t\right)\right) \omega_{k l},
$$
延拓算子分为两步, 首先通过数值积分计算固体网格高斯点处的值
$$
\tilde{\mathbf{U}}_{k l}=\sum_{i, j} \mathbf{u}_{i j} \delta_h\left(\mathbf{x}_{i j}-\mathcal{X}\left(\mathbf{X}_{k l}, t\right)\right) h^2
$$
再用得到的 $\tilde{\mathbf{U}}_{kl}$ 计算，将$\tilde{\mathbf{U}}$投影到 $\mathbf{F}$ 所属的有限元空间
$$
\int_{B_h} \mathbf{U}(\mathbf{X}, t) \mathbf{V}_h(\mathbf{X}) \mathrm{d} \mathbf{X}=\int_{B_h} \tilde{\mathbf{U}}(\mathbf{X}, t) \mathbf{V}_h(\mathbf{X}) \mathrm{d} \mathbf{X}
$$
此方法可以使不等式(32)为等式，且能够避免流体的流线穿透固体的现象。

### 5. 求解算法

引入离散的插值算子和延拓算子后，全离散格式可以写成
$$
\begin{gathered}
\frac{\rho}{\Delta t}\left({\mathbf{u}_{*}-\mathbf{u}_n}\right)-\mu \Delta \mathbf{u}_{*}=\mathbf{f}_{*} \\
\Delta^h p_{n+1}=\frac{1}{\Delta t} \nabla^h \cdot \mathbf{u}^*\\
\mathbf{u}^{n+1}=\mathbf{u}^*-\Delta t \nabla^h p_{n+1} \\
\int_{B_r} \mathbf{F}_{h,n+1} \cdot \mathbf{V d} \mathbf{x}=\int_{B_r} \mathbb{P}_{h,n+1}: \nabla \mathbf{V d} \mathbf{X}, \\
\mathbf{f}\left(\mathbf{x}, t_{n+1}\right)=\mathcal{J}_{h, n}\left(\mathbf{F}_{n+1}\right) \\
\mathbf{U}\left(\mathbf{X}, \mathbf{t}_{\mathbf{n}+\mathbf{1}}\right)=\mathcal{S}_{h, n}\left(\mathbf{u}_{n+1}\right)
\end{gathered}
$$
引入函数
$$
h_{n+1}\left(\mathcal{X}_{h,n+1}\right)=\frac{\mathcal{X}_{h,n+1}-\mathcal{X}_{h,n}}{\Delta t}-\mathbf{U}_{h,n+1}
$$
其中，$\mathbf{U}_{h,n+1}$为关于$\mathcal{X}_{h,n+1}$的非线形函数。为了简明符号，令$\mathcal{X}$为$\mathcal{X}_{h,n+1}$的系数构成的向量，即 $\mathcal{X}=\left\{\mathcal{X}_l(t_{n+1})\right\}_{l=1}^M$。我们采用迭代法求解方程(39)，构造一组序列 $\left\{\mathcal{X}_{n+1}^{(k)}\right\} $ 使得 $\left\|h_{n+1}\left(\mathcal{X}_{n+1}^{(k)}\right)\right\|$趋于零。 

#### 牛顿方法

求解 $\mathbf{h}_{n+1}\left(\mathcal{X}_{n+1}\right)=0$ 的 Newton 迭代公式为:
$$
h\left(\mathcal{X}_{n+1}^{(k)}\right)+J\left(\mathcal{X}_{n+1}^{(k)}\right)\left(\mathcal{X}_{n+1}^{(k+1)}-\mathcal{X}_{n+1}^{(k)}\right)=0
$$
其中 $J\left(\mathcal{X}_{n+1}^{(k)}\right)$ 为 Jacobian 矩阵
$$
J\left(\mathcal{X}_{n+1}^{(k)}\right)=\frac{\partial h\left(\mathcal{X}_{n+1}^{(k)}\right)}{\partial \mathcal{X}_{n+1}}
$$
但 $J\left(\mathcal{X}_{n+1}^{(k)}\right)$ 的解析表达式难以获得，我们可以采用差分方法求解雅可比矩阵。令 $\left[J\left(\mathcal{X}_{n+1}^{(k)}\right)\right]_{i, j}$ 表示雅可比矩阵的第 $i$ 行第 $j$ 列元素, 它可以通过差分方法(42)得。

$$
\left[J\left(\mathcal{X}_{n+1}^{(k)}\right)\right]_{i, j} \approx \frac{h_{n+1, i}\left(\mathcal{X}_{n+1}^{(k)}+\epsilon \mathbf{e}_j\right)-h_{n+1, i}\left(\mathcal{X}_{n+1}^{(k)}\right)}{\epsilon} .
$$
其中, $\mathbf{e}_j$ 是第 $\mathrm{j}$ 个元素为 1 的单位向量， $\epsilon$ 是一个极微小量, $h_{n+1, i}$ 表示 $h_{n+1}$ 的第 $\mathrm{i}$ 个自由度。这个过程涉及残差$h(\mathcal{X})$的求解。结合我们的数值格式，对于任意给定的 $\mathcal{X}_*$，残差可以通过下面五个步骤求解残差：

$$
\begin{gathered}
\int_{B_r} \mathbf{F}_* \cdot \mathbf{V} \mathrm{d} \mathbf{x}=\int_{B_r} \mathbb{P}_*: \nabla \mathbf{V} \mathrm{d} \mathbf{X}, \\
\mathbf{f}_*=\int_{B_r} \mathbf{F}_* \delta\left(\mathbf{x}-\mathcal{X}_n\right) \mathrm{d} \mathbf{X}, \\
\left\{\rho\left(\frac{\mathbf{u}_*-\mathbf{u}_n}{\Delta t}+\mathbf{u}_n \cdot \nabla \mathbf{u}^*\right)-\mu \Delta \mathbf{u}_{n+1}+\nabla p_*=\mathbf{f}_*,\right. \\
\nabla \cdot \mathbf{u}^*=0, \\
\mathbf{U}_{n+1}\left(\mathcal{X}_*\right)=\int_{\Omega} \mathbf{u}_* \delta\left(\mathbf{x}-\mathcal{X}_{\mathrm{n}}\right) d \mathbf{x},
\end{gathered}
$$
进而计算出残差 $\mathbf{h}\left(\mathcal{X}_*\right)$ 。

#### Jacobian-free Newton-Krylov 方法

通过残差方法计算Jacobian矩阵需要做 $N + 1$ 次残差计算才能得到系数矩阵，并且 Jacobian 矩阵的稀疏性未知，组装矩阵的组装与求解耗时。假设我们每步牛顿迭代都采用 Krylov 子空间法求解，令 $\mathbf{b}=-h_{n+1}\left(\mathcal{X}_{n+1}^{(k)}\right)$, $A=J\left(\mathcal{X}_{n+1}^{(k)}\right), \mathbf{x}=\left(\mathcal{X}_{n+1}^{(k+1)}-\mathcal{X}_{n+1}^{(k)}\right)$, 令初值 $\mathbf{x}^{(0)}=\mathbf{0}$，令线形系统的残差为 $\mathbf{v}=\mathbf{b}$，构造 $\mathrm{n}$ 维 Krylov 子空间
$$
\mathcal{K}_n(A, \mathbf{v})=\operatorname{span}\left\{\mathbf{v}, A \mathbf{v}, A^2 \mathbf{v}, \ldots, A^{n-1} \mathbf{v}\right\} \subseteq \mathbb{R}^N
$$
其中 $n \ll N$，我们可以通过迭代法在空间 $\mathcal{K}_n(A, \mathbf{v})$ 中找到 $\mathcal{X}_{n+1}$ 的近似解。JFNK 方法通过有限差分方法计算矩阵向量乘积, 无需知道 Jacobian 矩阵：
$$
A \mathbf{v}=\frac{\mathbf{h}_{n+1}\left(\mathcal{X}_{n+1}^{(k)}+\epsilon \mathbf{v}\right)-\mathbf{h}_{n+1}\left(\mathcal{X}_{n+1}^{(k)}\right)}{\epsilon} .
$$
为了保证本文采用Krylov子空间方法为 BiCGStab 方法。为了保证整体的效率, $\mathcal{X}_{n+1}^{(k+1)}$ 的求解通常不 要求达到很高的精度。

#### 6.数值结果











