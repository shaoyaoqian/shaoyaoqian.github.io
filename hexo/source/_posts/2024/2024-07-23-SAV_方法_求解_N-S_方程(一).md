---
title: SAV 方法求解 N-S 方程(一)
categories: []
tags: []
header: true
indent: false
mathjax: true
comments: true
toc:
  enable: true
cc_license: false
abbrlink: 2714
date: 2024-07-23 21:23:33
orig_author:
orig_src:
orig_url:
---
最基本的方法，要求源项为零，边界上的速度通量为零，没必要速度为零。方腔驱动圆盘算例满足边界条件。
<!-- more -->

### 连续方程
$$
\begin{equation}  
E(t)=\frac{\rho}{2}\int_\Omega|\mathbf{u}|^2\mathrm d \mathbf{x}
\end{equation}
$$

$$
\begin{equation}
  q = \sqrt{E(t)+\epsilon}
\end{equation}
$$

$$
\begin{equation}
    \frac{\mathrm d E\left(t\right)}{\mathrm d t} = \int_\Omega\rho\left(\frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\cdot\nabla\mathbf{u}\right)\cdot\mathbf{u}\mathrm d\mathbf{x}
\end{equation}
$$

$$
\begin{equation}
  \frac{\mathrm d q}{\mathrm d t}=\frac{1}{2q}\frac{\mathrm d E\left(t\right)}{\mathrm d t}= \frac{\rho}{2q}\int_\Omega\left(\frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\cdot\nabla\mathbf{u}\right)\cdot\mathbf{u}\mathrm d\mathbf{x}
\end{equation}
$$


### 时间离散
$$
\begin{equation}
    \rho\frac{\mathbf{u}_{n+1}-\mathbf{u}_n}{\Delta t}
    +\frac{\rho q_{n+1}}{\sqrt{E(\tilde{\mathbf{u}}_{n+1})+\delta}}(\mathbf{u}_n\cdot\nabla\mathbf{u}_{n})
    -\mu\Delta\mathbf{u}_{n+1}+\nabla p_{n+1}
    =\mathbf{f}_{n+1},
\end{equation}
$$

$$
\begin{equation}\frac{q_{n+1}-q_n}{\Delta t} = \frac{\rho}{2q^{n+1}}\left(\frac{\mathbf{u}_{n+1}-\mathbf{u}_n}{\Delta t}, \mathbf{u}_{n+1}\right) + \frac{\rho}{2\sqrt{E(\tilde{\mathbf{u}}_{n+1})+\delta}}\left(\mathbf{u}_n\cdot\nabla\mathbf{u}_n,\mathbf{u}_{n+1}\right),
    \end{equation}
$$

$$
\begin{equation}
      \label{semidiscrete:SAV:b}\nabla \cdot \mathbf{u}_{n+1}=0
    \end{equation}
$$

### 辅助变量求解
$$
\begin{equation}\label{SAV:S:1}
  S_{n+1}=\frac{q^{n+1}}{\sqrt{E\left(X^n\right)+\delta}},
  \quad \mathbf{u}^{n+1}=\mathbf{u}_1^{n+1}+S^{n+1} \mathbf{u}_2^{n+1}, 
  \quad p^{n+1}=p_1^{n+1}-S^{n+1} p_2^{n+1}
\end{equation}
$$
$$
\begin{equation}\label{SAV:S:5}
  \begin{aligned}
  & X_{1, n+1}=\frac{2}{\Delta t}\left(E\left(\tilde{\mathbf{u}}^{n+1}\right)+\delta\right)+{\mu}\left\|\nabla \mathbf{u}_2^{n+1}\right\|^2, \\
  & X_{2, n+1}=-\frac{2 q^n}{\Delta t} \sqrt{E\left(\tilde{\mathbf{u}}^{n+1}\right)+\delta}
  +{2\mu}\left(\nabla\mathbf{u}_1^{n+1}, \nabla \mathbf{u}_2^{n+1}\right)
  -\left(\mathbf{g}^{n+1}, \mathbf{u}_2^{n+1}\right), \\
  & X_{3, n+1}={\mu}\left\|\nabla\left(\mathbf{u}_1^{n+1}\right)\right\|^2-\left(\mathbf{g}^{n+1}, \mathbf{u}_1^{n+1}\right) .
  \end{aligned}
\end{equation}
$$
