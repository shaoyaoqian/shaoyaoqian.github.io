{### 前端 ###}
<script {{pjax}} src="/main.js"></script>

{### 评论 ###}
{###
<script src="/waline.js"></script> ###}

{### 音乐 ###}
<script src="/musicplayer.js"></script>

{### 友链列表 ###}
<script{{ pjax }} type="text/javascript">
  //jquery selector
  var $linkList = $(".link-list");
  if ($linkList.length != 0) {
    var j = -1;
    for	(var i = 0; i < $linkList.length; i++) {
      const listPath = $linkList[i].getAttribute('json-src');
      const iconPath = $linkList[i].getAttribute('icon-src');
      //使用 getJSON 读取 JSON 文件中的数据
      $.getJSON(listPath, function(data) {
        j++;
        //存储数据的变量 
        var li = "";
        //清空内容 
        $linkList.eq(j).empty();
        //将获取到的 json 格式数据遍历到 div 中
        $.each(data, function(infoIndex, info) {
          var labelWarn = '';
          var labelInfo = '';
          if (info['warn']) { 
            labelWarn = '<span class="label warn">' + info['warn'] + '</span>';
          }
          if (info['info']) { 
            labelInfo = '<span class="label info">' + info['info'] + '</span>';
          }
          li += '<div class="link-list-container">';
          li += '<img class="link-list-image" src="' + iconPath + info['logo'] + '">';
          li += '<p>' + info['title'] + labelInfo + labelWarn + '</p>';
          li += '<p>' + info['intro'] + '</p>';
          li += '<a href="' + info['url'] + '" rel="noopener" target="_blank" data-pjax-state=""></a>';
          li += '</div>';
        })
        //显示处理后的数据 
        $linkList.eq(j).html(li);
      })
    }
  }
</script> 


{### Upload files to GitHub ###}
{### <input type="file" id="fileInput">

<script type="module">
  import { Octokit } from "https://cdn.skypack.dev/@octokit/core";
  var owner = "shaoyaoqian"
  var repo = "shaoyaoqian.github.io"
  var release_id = "RELEASE_ID"
  var token = "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"
  var filename = ".gitignore"
  var access_token = token
  var tag = "v1.0.0"
  const octokit = new Octokit({
    auth: token
  })
// curl \
//   -X POST \
//   -H "Accept: application/vnd.github+json" \
//   -H "Authorization: Bearer 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"\
//   -H "X-GitHub-Api-Version: 2022-11-28" \
//   -H "Content-Type: application/octet-stream" \
//   "https://uploads.github.com/repos/shaoyaoqian/shaoyaoqian.github.io/releases/91834017/assets?name=example.zip" \
//   --data-binary "@a.py"

  async function uploadFile(file) {
    // 获取最新的 release 信息
    const latestRelease = await octokit.request('GET /repos/{owner}/{repo}/releases/latest', {
      owner: owner,
      repo: repo
    })
    var release_id = latestRelease.data.id;
    filename = file.name;
    release_id = 91834017
    
    // url = `https://uploads.github.com/repos/${owner}/${repo}/releases/${release_id}/assets?name=${filename}`;
    await octokit.request('PUT /repos/{owner}/{repo}/contents/{path}', {
      owner: owner,
      repo: repo,
      path: 'album',
      message: 'my commit message',
      committer: {
        name: 'Monalisa Octocat',
        email: 'octocat@github.com'
      },
      headers: {
            "content-type": "text/plain",
          },
      label: "test",
      name: "test-upload.txt",
      // content: 'bXkgbmV3IGZpbGUgY29udGVudHM='
    })
    console.log(url);
  }

  
  // document.querySelector("#fileInput").addEventListener("change", async function() {
  //   const file = this.files[0];
  //   await uploadFile(file);
  // });
</script>
 ###}


 