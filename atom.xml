<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>离疯狂最近的地方</title>
  
  <subtitle>只能短暂 所以大嚷</subtitle>
  <link href="https://www.pengfeima.cn/atom.xml" rel="self"/>
  
  <link href="https://www.pengfeima.cn/"/>
  <updated>2025-01-26T08:00:29.762Z</updated>
  <id>https://www.pengfeima.cn/</id>
  
  <author>
    <name>我家宝宝</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>SAV 方法求解流固耦合问题(二)</title>
    <link href="https://www.pengfeima.cn/posts/38426/"/>
    <id>https://www.pengfeima.cn/posts/38426/</id>
    <published>2024-07-23T16:24:52.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>求解的流固耦合问题中，流体的速度为非齐次Dirichlet边界条件。<span id="more"></span></p><h2 id="一阶时间离散">一阶时间离散：</h2><p>如果边界速度不为0， <span class="math display">\[E(t)=\frac{\rho}{2}\int_{\Omega}|\mathbf{u}|^{2}+\int_{B_{r}}W(\mathcal{X})\]</span></p><p><span class="math display">\[\begin{split}\frac{dE(t)}{dt}&amp;=\rho\int_{\Omega}\frac{\partial\mathbf{u}}{\partialt}\cdot\mathbf{u}+\int_{B_{r}}\frac{\partial W}{\partial t}\\&amp;=\rho\int_{\Omega}(\frac{\partial\mathbf{u}}{\partialt}+\mathbf{u}\cdot\nabla\mathbf{u})\cdot\mathbf{u}-\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{u})|\mathbf{u}|^{2}+\int_{B_{r}}\frac{\partialW}{\partial \mathbb{F}}:\frac{\partial \mathbb{F}}{\partial t}\end{split}\]</span></p><p>令<span class="math inline">\(q=\sqrt{E(t)+\delta}\)</span> <spanclass="math display">\[\begin{split}\frac{dq}{dt}&amp;=\frac{1}{2}\frac{1}{\sqrt{E(t)+\delta}}\frac{dE(t)}{dt}=\frac{1}{2q}\frac{dE(t)}{dt}\\&amp;=\frac{1}{2q}\left(\rho\int_{\Omega}(\frac{\partial\mathbf{u}}{\partialt}+\mathbf{u}\cdot\nabla\mathbf{u})\cdot\mathbf{u}-\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{u})|\mathbf{u}|^{2}+\int_{B_{r}}\frac{\partialW}{\partial \mathbb{F}}:\frac{\partial \mathbb{F}}{\partial t}\right)\end{split}\]</span> 那么IB方法等价于 <span class="math display">\[\begin{split}&amp;\rho(\frac{\partial{\mathbf{u}}}{\partialt}+\frac{q}{\sqrt{E(t)+\delta}}\mathbf{u}\cdot\nabla\mathbf{u})-\mu\Delta\mathbf{u}+\nabla p= \frac{q}{\sqrt{E(t)+\delta}}f\\&amp;\frac{dq}{dt}=\frac{\rho}{2q}\int_{\Omega}(\frac{\partial\mathbf{u}}{\partialt}+\mathbf{u}\cdot\nabla\mathbf{u})\cdot\mathbf{u}-\frac{\rho}{4q}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{u})|\mathbf{u}|^{2}+\frac{1}{2q}\int_{B_{r}}\frac{\partialW}{\partial \mathbb{F}}:\frac{\partial \mathbb{F}}{\partial t}\\&amp;\nabla\cdot\mathbf{u}=0\\&amp;\int_{B_{r}}\mathbf{F}\cdot\mathbf{V}=-\int_{B_{r}}\mathbb{P}:\nabla\mathbf{V}\\&amp;\mathbf{f}=\int_{B_{r}}\mathbf{F}\cdot\delta(\mathbf{x}-\mathcal{X}(\mathbf{X},t)d\mathbf{X}\\&amp;\frac{\partial\mathcal{X}}{\partialt}=\int_{\Omega}\mathbf{u}\cdot\delta(\mathbf{x}-\mathcal{X}(\mathbf{X},t))d\mathbf{x}\end{split}\]</span> 数值格式： <span class="math display">\[\begin{equation}\label{1}\begin{split}&amp;\rho\frac{\mathbf{u}^{n+1}-\mathbf{u}^{n}}{\Deltat}-\mu\Delta\mathbf{u^{n+1}}+\nablap^{n+1}=\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n})\\&amp;\frac{q^{n+1}-q^{n}}{\Delta t}=\frac{1}{2q^{n+1}}\frac{\rho}{\Deltat}\int_{\Omega}(\mathbf{u}^{n+1}-\mathbf{u}^{n})\cdot\mathbf{u}^{n+1}+\frac{\rho}{2\sqrt{E(\bar{t})+\delta}}\int_{\Omega}\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}\cdot\mathbf{u}^{n+1}-\frac{\rho}{4q^{n+1}}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{u}^{n+1})|\mathbf{u^{n+1}}|^{2}+\frac{1}{2\sqrt{E(\bar{t})+\delta}}\int_{B_{r}}\mathbb{P}^{n}:\frac{\mathbb{F}^{n+1}-\mathbb{F}^{n}}{\Delta t}\\&amp;\nabla\cdot\mathbf{u}^{n+1}=0\\&amp;\int_{B_{r}}\mathbf{F}^{n}\cdot\mathbf{V}=-\int_{B_{r}}\mathbb{P}^{n}:\nabla\mathbf{V}\\&amp;\mathbf{f}^{n}=\int_{B_{r}}\mathbf{F}^{n}\cdot\delta(\mathbf{x}-\mathcal{X}(\mathbf{X},t)d\mathbf{X}\\&amp;\frac{\mathcal{X}^{n+1}-\mathcal{X}^{n}}{\Deltat}=\int_{\Omega}\mathbf{u}^{n+1}\cdot\delta(\mathbf{x}-\mathcal{X}(\mathbf{X},t))d\mathbf{x}\end{split}\end{equation}\]</span> 给方程1-1的两边关于<spanclass="math inline">\(\mathbf{u}^{n+1}\)</span>做<spanclass="math inline">\(L^{2}\)</span>内积,同时利用1-3式可得： <spanclass="math display">\[\begin{split}&amp;\frac{\rho}{\Deltat}\int_{\Omega}(\mathbf{u}^{n+1}-\mathbf{u}^{n})\cdot\mathbf{u}^{n+1}-\mu\int_{\Omega}\Delta\mathbf{u}^{n+1}\cdot\mathbf{u}^{n+1}+\int_{\Omega}\nablap^{n+1}\cdot\mathbf{u}^{n+1}=\int_{\Omega}\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}(f^{n}-\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n})\cdot\mathbf{u}^{n+1}\\&amp;\frac{\rho}{\Deltat}\int_{\Omega}(\mathbf{u}^{n+1}-\mathbf{u}^{n})\cdot\mathbf{u}^{n+1}-\left(\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}^{n+1})\cdot\mathbf{u}^{n+1}-\mu\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}\right)+\left(\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{u}^{n+1})p^{n+1}-\int_{\Omega}p^{n+1}\nabla\cdot\mathbf{u}^{n+1}\right)\\&amp;=\int_{\Omega}\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}(f^{n}-\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n})\cdot\mathbf{u}^{n+1}\\&amp;\textcolor{red}{\frac{\rho}{\Deltat}\int_{\Omega}(\mathbf{u}^{n+1}-\mathbf{u}^{n})\cdot\mathbf{u}^{n+1}}-\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}^{n+1})\cdot\mathbf{u}^{n+1}+\mu\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}+\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{u}^{n+1})p^{n+1}\\&amp;=\int_{\Omega}\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{f}^{n}\cdot\mathbf{u}^{n+1}\textcolor{red}{-\int_{\Omega}\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}\cdot\mathbf{u}^{n+1}}\end{split}\]</span> 给方程1-2两边同时乘以<spanclass="math inline">\(2q^{n+1}\)</span>可得： <spanclass="math display">\[2q^{n+1}(\frac{q^{n+1}-q^{n}}{\Delta t})=\textcolor{red}{\frac{\rho}{\Deltat}\int_{\Omega}(\mathbf{u}^{n+1}-\mathbf{u}^{n})\cdot\mathbf{u}^{n+1}}\textcolor{red}{+\frac{\rhoq^{n+1}}{\sqrt{E(\bar{t})+\delta}}\int_{\Omega}\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}\cdot\mathbf{u}^{n+1}}-\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{u}^{n+1})|\mathbf{u^{n+1}}|^{2}+\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\int_{B_{r}}\mathbb{P}^{n}:\frac{\mathbb{F}^{n+1}-\mathbb{F}^{n}}{\Delta t}\]</span> 将上面的两式相加可得： <span class="math display">\[\begin{equation}\begin{split}2q^{n+1}(\frac{q^{n+1}-q^{n}}{\Deltat})=-\mu\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}+\int_{\Omega}\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{f}^{n}\cdot\mathbf{u}^{n+1}+\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}^{n+1})\cdot\mathbf{w}^{n+1}-\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})p^{n+1}\\-\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})|\mathbf{w}^{n+1}|^{2}+\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\int_{B_{r}}\mathbb{P}^{n}:\frac{\mathbb{F}^{n+1}-\mathbb{F}^{n}}{\Delta t}\end{split}\end{equation}\]</span> 令1-4式中的<spanclass="math inline">\(\mathbf{V}=\mathcal{X}^{n+1}-\mathcal{X}^{n}\)</span>,则 <span class="math display">\[\begin{split}\int_{B_{r}}\mathbf{F}^{n}\cdot(\mathcal{X}^{n+1}-\mathcal{X}^{n})&amp;=-\int_{B_{r}}\mathbb{P}^{n}:\nabla(\mathcal{X}^{n+1}-\mathcal{X}^{n})\\&amp;=-\int_{B_{r}}\mathbb{P}^{n}:(\mathbb{F}^{n+1}-\mathbb{F}^{n})\end{split}\]</span> 将上式代入中可得： <span class="math display">\[2q^{n+1}(\frac{q^{n+1}-q^{n}}{\Deltat})=-\mu\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}+\int_{\Omega}\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{f}^{n}\cdot\mathbf{u}^{n+1}+\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}^{n+1})\cdot\mathbf{w}^{n+1}-\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})p^{n+1}\\-\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})|\mathbf{w}^{n+1}|^{2}-\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\frac{1}{\Deltat}\int_{B_{r}}\mathbf{F}^{n}\cdot(\mathcal{X}^{n+1}-\mathcal{X}^{n})\]</span> 对于1-5式关于<spanclass="math inline">\(\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{u}^{n+1}\)</span>关于<spanclass="math inline">\(L^{2}\)</span>做内积可得： <spanclass="math display">\[(\mathbf{f}^{n},\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{u}^{n+1})_{\Omega}=(\int_{B_{r}}\mathbf{F}^{n}\cdot\delta(\mathbf{x}-\mathcal{X}(\mathbf{X},t)d\mathbf{X}，\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{u}^{n+1})_{\Omega}\]</span> 对于1-6式关于<spanclass="math inline">\(\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{F}^{n}\)</span>关于<spanclass="math inline">\(L^{2}\)</span>做内积可得： <spanclass="math display">\[\frac{1}{\Deltat}(\mathcal{X}^{n+1}-\mathcal{X}^{n},\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{F}^{n})_{B_{r}}=(\int_{\Omega}\mathbf{u}^{n+1}\cdot\delta(\mathbf{x}-\mathcal{X}(\mathbf{X},t))d\mathbf{x},\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{F}^{n})_{B_{r}}\]</span> 根据插值算子和延拓算子满足对偶性可得 <spanclass="math display">\[\Deltat(\mathbf{f}^{n},\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{u}^{n+1})_{\Omega}=(\mathcal{X}^{n+1}-\mathcal{X}^{n},\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\mathbf{F}^{n})_{B_{r}}\]</span> 代入表达式中可得 <span class="math display">\[2q^{n+1}(\frac{q^{n+1}-q^{n}}{\Deltat})=-\mu\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}+\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}^{n+1})\cdot\mathbf{w}^{n+1}-\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})p^{n+1}\\-\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})|\mathbf{w}^{n+1}|^{2}\]</span> 定理1：如果边界速度<spanclass="math inline">\(\mathbf{w}^{n+1}=0\)</span>,数值格式满足下面的等式，且是无条件能量稳定的。<span class="math display">\[2q^{n+1}(\frac{q^{n+1}-q^{n}}{\Deltat})+\mu\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}=0\]</span></p><h2 id="数值实现过程">数值实现过程：</h2><p>令<spanclass="math inline">\(S=\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\)</span>,那么N-S方程可写成：<span class="math display">\[\frac{\rho}{\Delta t}\mathbf{u}^{n+1}+\nablap^{n+1}-\mu\Delta\mathbf{u^{n+1}}=S(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}))+\frac{\rho}{\Delta t}\mathbf{u}^{n}\\\]</span> 由于<spanclass="math inline">\(\nabla\cdot\mathbf{u}^{n+1}=0\)</span>, 那么 <spanclass="math display">\[\frac{\rho}{\Delta t}\mathbf{u}^{n+1}+\nablap^{n+1}=S(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}))+\frac{\rho}{\Deltat}\mathbf{u}^{n}-\mu\nabla\times\nabla\times\mathbf{u}^{n+1}\]</span> 令<spanclass="math inline">\(q\)</span>是连续空间上的任意测试函数，则上式关于<spanclass="math inline">\(\nabla q\)</span>做<spanclass="math inline">\(L^{2}\)</span>内积可得： <spanclass="math display">\[\int_{\Omega}\nabla p^{n+1}\cdot\nablaq=\int_{\Omega}S(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n})\cdot\nablaq-\mu\int_{\partial\Omega}\mathbf{n}\times\mathbf{\omega}^{n+1}\cdot\nablaq-\frac{\rho}{\Delta t}\int_{\Omega}\mathbf{n}\cdot\mathbf{w}^{n+1}q\]</span> 其中<spanclass="math inline">\(\mathbf{\omega}=\nabla\times\mathbf{u}\)</span>和<spanclass="math inline">\(\int_{\Omega}\nabla\times\mathbf{\omega}\cdot\nabla q=\int_{\partial\Omega}\mathbf{n}\times\mathbf{\omega}\cdot\nabla q\)</span>.为了简化计算，则<spanclass="math inline">\(\mathbf{n}\times\mathbf{\omega}^{n+1}=\mathbf{n}\times\mathbf{\bar{\omega}}^{n+1}|_{\partial\Omega}\)</span>, 其中<spanclass="math inline">\(\mathbf{\bar{\omega}}^{n+1}=\nabla\times\mathbf{u}^{n}\)</span>,显示表示。从而上式可表示 <span class="math display">\[\int_{\Omega}\nabla p^{n+1}\cdot\nablaq=\int_{\Omega}S(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n})\cdot\nablaq-\mu\int_{\partial\Omega}\mathbf{n}\times\nabla\times\mathbf{u}^{n}\cdot\nablaq-\frac{\rho}{\Delta t}\int_{\Omega}\mathbf{n}\cdot\mathbf{w}^{n+1}q\\\int_{\Omega}p^{n+1}=0\]</span> 上式可求解<span class="math inline">\(p^{n+1}\)</span>.</p><p>如何求解<span class="math inline">\(p^{n+1}\)</span></p><p>1）对于<span class="math inline">\(p^{n+1}_{1}\)</span>: <spanclass="math display">\[\int_{\Omega}\nabla p_{1}^{n+1}\cdot\nablaq=-\mu\int_{\partial\Omega}\mathbf{n}\times\nabla\times\mathbf{u}^{n}\cdot\nablaq-\frac{\rho}{\Delta t}\int_{\Omega}\mathbf{n}\cdot\mathbf{w}^{n+1}q\\\int_{\Omega}p_{1}^{n+1}=0\]</span> 1）对于<span class="math inline">\(p^{n+1}_{2}\)</span>: <spanclass="math display">\[\int_{\Omega}\nabla p_{2}^{n+1}\cdot\nablaq=\int_{\Omega}(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n})\cdot\nabla q\\\int_{\Omega}p_{2}^{n+1}=0\]</span> 很容易验证<spanclass="math inline">\(p^{n+1}=p_{1}^{n+1}+Sp_{2}^{n+1}\)</span></p><p>利用<spanclass="math inline">\(p^{n+1}=p_{1}^{n+1}+Sp_{2}^{n+1}\)</span>，则<span class="math display">\[\frac{\rho}{\mu\Deltat}\mathbf{u}^{n+1}-\Delta\mathbf{u^{n+1}}=\frac{S}{\mu}(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}-\nabla p^{n+1}_{2})+(\frac{\rho}{\mu\Deltat}\mathbf{u}^{n}-\frac{1}{\mu}\nabla p_{1}^{n+1})\\\]</span> 令<spanclass="math inline">\(\phi\)</span>是任意测试函数，且<spanclass="math inline">\(\phi|_{\Omega}=0\)</span>,对上述关于<spanclass="math inline">\(\phi\)</span>做<spanclass="math inline">\(L^{2}\)</span>内积， <span class="math display">\[\frac{\rho}{\mu\Deltat}\int_{\Omega}\mathbf{u}^{n+1}\phi+\int_{\Omega}\nabla\phi\cdot\nabla\mathbf{u^{n+1}}=\frac{S}{\mu}\int_{\Omega}(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}-\nablap^{n+1}_{2})\phi+\int_{\Omega}(\frac{\rho}{\mu\Deltat}\mathbf{u}^{n}-\frac{1}{\mu}\nabla p_{1}^{n+1})\phi\]</span> 上式可求<spanclass="math inline">\(\mathbf{u}^{n+1}\)</span></p><p>如何求解<span class="math inline">\(\mathbf{u}^{n+1}\)</span></p><p>1）对于<span class="math inline">\(\mathbf{u}^{n+1}_{1}\)</span>:<span class="math display">\[\frac{\rho}{\mu\Deltat}\int_{\Omega}\mathbf{u}_{1}^{n+1}\phi+\int_{\Omega}\nabla\phi\cdot\nabla\mathbf{u}_{1}^{n+1}=\int_{\Omega}(\frac{\rho}{\mu\Deltat}\mathbf{u}^{n}-\frac{1}{\mu}\nabla p_{1}^{n+1})\phi\\\mathbf{u}_{1}^{n+1}=\mathbf{w}^{n+1}\]</span> 1）对于<spanclass="math inline">\(\mathbf{u}^{n+1}_{2}\)</span>: <spanclass="math display">\[\frac{\rho}{\mu\Deltat}\int_{\Omega}\mathbf{u}_{2}^{n+1}\phi+\int_{\Omega}\nabla\phi\cdot\nabla\mathbf{u}_{2}^{n+1}=\frac{1}{\mu}\int_{\Omega}(f^{n}-\rho\mathbf{u}^{n}\cdot\nabla\mathbf{u}^{n}-\nabla p^{n+1}_{2})\phi\\\mathbf{u}_{1}^{n+1}=0\]</span> 很容易验证<spanclass="math inline">\(\mathbf{u}^{n+1}=\mathbf{u}_{1}^{n+1}+S\mathbf{u}_{2}^{n+1}\)</span><span class="math display">\[2q^{n+1}(\frac{q^{n+1}-q^{n}}{\Deltat})=-\mu\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}+\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}^{n+1})\cdot\mathbf{w}^{n+1}-\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})p^{n+1}\\-\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})|\mathbf{w}^{n+1}|^{2}\]</span> 上述方程两边同时乘以<spanclass="math inline">\(\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\)</span>则<span class="math display">\[2q^{n+1}(\frac{q^{n+1}-q^{n}}{\Deltat})\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}=-\mu\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\int_{\Omega}|\nabla\mathbf{u}^{n+1}|^{2}+\mu\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}^{n+1})\cdot\mathbf{w}^{n+1}-\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})p^{n+1}\\-\frac{q^{n+1}}{\sqrt{E(\bar{t})+\delta}}\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})|\mathbf{w}^{n+1}|^{2}\\\]</span> 则 <span class="math display">\[\frac{2}{\Delta t}S^{3}(E(\bar{t})+\delta)-\frac{2 q^{n}}{\Deltat}S^{2}\sqrt{E(\bar{t})+\delta}+A_{1}S+A_{2}S^{2}+A_{3}S^{3}=0\\A_{1}=\mu\int_{\Omega}|\nabla\mathbf{u}_{1}^{n+1}|^{2}-\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}_{1}^{n+1})\cdot\mathbf{w}^{n+1}+\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})p_{1}^{n+1}+\frac{\rho}{2}\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})|\mathbf{w}^{n+1}|^{2}\\A_{2}=2\mu\int_{\Omega}\nabla \mathbf{u}^{n+1}_{1}:\nabla\mathbf{u}^{n+1}_{2}-\mu\int_{\partial\Omega}(\mathbf{n}\cdot\nabla\mathbf{u}_{2}^{n+1})\cdot\mathbf{w}^{n+1}+\int_{\partial\Omega}(\mathbf{n}\cdot\mathbf{w}^{n+1})p_{2}^{n+1}\\A_{3}=\mu\int_{\Omega}|\nabla\mathbf{u}_{2}^{n+1}|^{2}\]</span></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;求解的流固耦合问题中，流体的速度为非齐次Dirichlet边界条件。</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>SAV 方法求解 N-S 方程(一)</title>
    <link href="https://www.pengfeima.cn/posts/2714/"/>
    <id>https://www.pengfeima.cn/posts/2714/</id>
    <published>2024-07-23T13:23:33.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>最基本的方法，要求源项为零，边界上的速度通量为零，没必要速度为零。方腔驱动圆盘算例满足边界条件。<span id="more"></span></p><h3 id="连续方程">连续方程</h3><p><span class="math display">\[\begin{equation}  E(t)=\frac{\rho}{2}\int_\Omega|\mathbf{u}|^2\mathrm d \mathbf{x}\end{equation}\]</span></p><p><span class="math display">\[\begin{equation}  q = \sqrt{E(t)+\epsilon}\end{equation}\]</span></p><p><span class="math display">\[\begin{equation}    \frac{\mathrm d E\left(t\right)}{\mathrm d t} =\int_\Omega\rho\left(\frac{\partial \mathbf{u}}{\partialt}+\mathbf{u}\cdot\nabla\mathbf{u}\right)\cdot\mathbf{u}\mathrmd\mathbf{x}\end{equation}\]</span></p><p><span class="math display">\[\begin{equation}  \frac{\mathrm d q}{\mathrm d t}=\frac{1}{2q}\frac{\mathrm dE\left(t\right)}{\mathrm d t}=\frac{\rho}{2q}\int_\Omega\left(\frac{\partial \mathbf{u}}{\partialt}+\mathbf{u}\cdot\nabla\mathbf{u}\right)\cdot\mathbf{u}\mathrmd\mathbf{x}\end{equation}\]</span></p><h3 id="时间离散">时间离散</h3><p><span class="math display">\[\begin{equation}    \rho\frac{\mathbf{u}_{n+1}-\mathbf{u}_n}{\Delta t}    +\frac{\rhoq_{n+1}}{\sqrt{E(\tilde{\mathbf{u}}_{n+1})+\delta}}(\mathbf{u}_n\cdot\nabla\mathbf{u}_{n})    -\mu\Delta\mathbf{u}_{n+1}+\nabla p_{n+1}    =\mathbf{f}_{n+1},\end{equation}\]</span></p><p><span class="math display">\[\begin{equation}\frac{q_{n+1}-q_n}{\Delta t} =\frac{\rho}{2q^{n+1}}\left(\frac{\mathbf{u}_{n+1}-\mathbf{u}_n}{\Deltat}, \mathbf{u}_{n+1}\right) +\frac{\rho}{2\sqrt{E(\tilde{\mathbf{u}}_{n+1})+\delta}}\left(\mathbf{u}_n\cdot\nabla\mathbf{u}_n,\mathbf{u}_{n+1}\right),    \end{equation}\]</span></p><p><span class="math display">\[\begin{equation}      \label{semidiscrete:SAV:b}\nabla \cdot \mathbf{u}_{n+1}=0    \end{equation}\]</span></p><h3 id="辅助变量求解">辅助变量求解</h3><p><span class="math display">\[\begin{equation}\label{SAV:S:1}  S_{n+1}=\frac{q^{n+1}}{\sqrt{E\left(X^n\right)+\delta}},  \quad \mathbf{u}^{n+1}=\mathbf{u}_1^{n+1}+S^{n+1} \mathbf{u}_2^{n+1},  \quad p^{n+1}=p_1^{n+1}-S^{n+1} p_2^{n+1}\end{equation}\]</span> <span class="math display">\[\begin{equation}\label{SAV:S:5}  \begin{aligned}  &amp; X_{1, n+1}=\frac{2}{\Deltat}\left(E\left(\tilde{\mathbf{u}}^{n+1}\right)+\delta\right)+{\mu}\left\|\nabla\mathbf{u}_2^{n+1}\right\|^2, \\  &amp; X_{2, n+1}=-\frac{2 q^n}{\Delta t}\sqrt{E\left(\tilde{\mathbf{u}}^{n+1}\right)+\delta}  +{2\mu}\left(\nabla\mathbf{u}_1^{n+1}, \nabla\mathbf{u}_2^{n+1}\right)  -\left(\mathbf{g}^{n+1}, \mathbf{u}_2^{n+1}\right), \\  &amp; X_{3,n+1}={\mu}\left\|\nabla\left(\mathbf{u}_1^{n+1}\right)\right\|^2-\left(\mathbf{g}^{n+1},\mathbf{u}_1^{n+1}\right) .  \end{aligned}\end{equation}\]</span></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;最基本的方法，要求源项为零，边界上的速度通量为零，没必要速度为零。方腔驱动圆盘算例满足边界条件。</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>方腔驱动流的数值解</title>
    <link href="https://www.pengfeima.cn/posts/44705/"/>
    <id>https://www.pengfeima.cn/posts/44705/</id>
    <published>2024-07-23T07:14:25.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>方腔驱动流的数值解 <span id="more"></span></p><p>数值解 lid-driven cavity flow<a href="#fn1" class="footnote-ref"id="fnref1" role="doc-noteref"><sup>1</sup></a><a href="#fn2"class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a><ahref="#fn3" class="footnote-ref" id="fnref3"role="doc-noteref"><sup>3</sup></a><a href="#fn4" class="footnote-ref"id="fnref4" role="doc-noteref"><sup>4</sup></a><a href="#fn5"class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p><ul><li><p>考虑雷诺数 <spanclass="math inline">\(Re=1000,5000,7500\)</span>,</p></li><li><p>二维问题，<span class="math inline">\(Re\approx7500\)</span>，会出现出现 Hopf bifurcation<a href="#fn6" class="footnote-ref"id="fnref6" role="doc-noteref"><sup>6</sup></a>,</p></li><li><p><span class="math inline">\(Re&lt;7500\)</span>,收敛到稳定解,</p></li><li><p><span class="math inline">\(Re&gt;7500\)</span>,稳定解和周期解。如果稳定解存在，初解和空间分辨率选取适当，那么能得到稳定解。</p></li></ul><p><strong>结果比较</strong>:</p><ol type="1"><li>图流线图</li><li>画出 <span class="math inline">\(x =0.5\)</span>, <spanclass="math inline">\(y =0.5\)</span> 两条线上，u, v, p，</li></ol><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150328892.png"alt="image-20240723150328892" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150349831.png"alt="image-20240723150349831" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150407377.png"alt="image-20240723150407377" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150430359.png"alt="image-20240723150430359" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150455543.png"alt="image-20240723150455543" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150558084.png"alt="image-20240723150558084" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150630284.png"alt="image-20240723150630284" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/image-20240723150653531.png"alt="image-20240723150653531" /></div></div></div><p><img data-src="https://githubimages.pengfeima.cn/images/image-20240723145058748.png" /></p><aside id="footnotes" class="footnotes footnotes-end-of-document"role="doc-endnotes"><hr /><ol><li id="fn1"><p>Griffith, Boyce E. 《An Accurate and Efficient Methodfor the Incompressible Navier–Stokes Equations Using the ProjectionMethod as a Preconditioner》. <em>Journal of Computational Physics</em>228, 期 20 (2009年11月): 7565–95.https://doi.org/10.1016/j.jcp.2009.07.001.<a href="#fnref1"class="footnote-back" role="doc-backlink">↩︎</a></p></li><li id="fn2"><p>U. Ghia, K.N. Ghia, C.T. Shin, High-Re solutions forincompressible flow using the Navier–Stokes equations and a multigridmethod, J. Comput. Phys. 48 (3) (1982) 387–411.<a href="#fnref2"class="footnote-back" role="doc-backlink">↩︎</a></p></li><li id="fn3"><p>O. Botella, R. Peyret, Benchmark spectral results on thelid-driven cavity flow, Comput. Fluid 27 (4) (1998) 421–433.<ahref="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li><li id="fn4"><p>E. Erturk, T.C. Corke, C. Gökçöl, Numerical solutions of2-D steady incompressible driven cavity flow at high Reynolds numbers,Int. J. Numer. Methods Fluid 48 (7) (2005) 747–774.<a href="#fnref4"class="footnote-back" role="doc-backlink">↩︎</a></p></li><li id="fn5"><p>C.J. Roy, A.J. Sinclair, On the generation of exactsolutions for evaluating numerical schemes and estimating discretizationerror, J. Comput. Phys. 228 (5) (2009) 1790–1802.<a href="#fnref5"class="footnote-back" role="doc-backlink">↩︎</a></p></li><li id="fn6"><p>Y.-F. Peng, Y.H. Shiau, R.R. Hwang, Transition in a 2-Dlid-driven cavity flow, Comput. Fluid 32 (3) (2003) 337–352.<ahref="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li></ol></aside>]]></content>
    
    
    <summary type="html">&lt;p&gt;方腔驱动流的数值解</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>SAV 方法求解 N-S 方程(二)</title>
    <link href="https://www.pengfeima.cn/posts/34792/"/>
    <id>https://www.pengfeima.cn/posts/34792/</id>
    <published>2024-07-21T12:13:16.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>SAV <span id="more"></span></p><h3 id="半离散格式的构造">半离散格式的构造</h3><p>这种格式的显著特征是引入了一个与N-S系统总能量关联的辅助变量(auxiliaryvariable)。辅助变量的定义如下，在定义能量的时候包含了对流项的边界积分。<span class="math display">\[R(t)=\sqrt{E(t)}\]</span> (3)和(4)为动量方程和辅助变量方程， <spanclass="math display">\[\frac{\partial \mathbf{u}}{\partial t}+\mathbf{N}(\mathbf{u})+\nablap-\nu \nabla^2 \mathbf{u}=\mathbf{f},\tag{3}\]</span></p><p><span class="math display">\[\begin{aligned}2 R \frac{d R}{d t}=\frac{d E}{d t}=\int_{\Omega} \frac{\partial\mathbf{u}}{\partial t} \cdot\mathbf{u}=\int_{\Omega}\left(\frac{\partial \mathbf{u}}{\partialt}+\mathbf{u} \cdot \nabla \mathbf{u}\right) \cdot\mathbf{u}-\int_{\partial \Omega}(\mathbf{n} \cdot \mathbf{u})\frac{1}{2}|\mathbf{u}|^2\end{aligned}\]</span></p><p>根据定义，方程(3)和方程(4)可以修改成(5)和(6)。 <spanclass="math display">\[\frac{\partial \mathbf{u}}{\partial t}+\frac{R(t)}{\sqrt{E(t)}}\mathbf{N}(\mathbf{u})+\nabla p-v \nabla^2 \mathbf{u}=\mathbf{f}.\tag{5}\]</span> <span class="math display">\[2 R \frac{d R}{d t}=\int_{\Omega}\left[\frac{\partial\mathbf{u}}{\partial t}+\frac{R(t)}{\sqrt{E(t)}}\mathbf{N}(\mathbf{u})\right] \cdot \mathbf{u}-\int_{\partial\Omega}(\mathbf{n} \cdot \mathbf{u}) \frac{1}{2}|\mathbf{u}|^2 .\tag{6}\]</span></p><p>方程(5)和方程(6)加上以下几个条件后完备。 <spanclass="math display">\[\begin{aligned}&amp; \mathbf{u}|_{\partial \Omega}=\mathbf{w}(\mathbf{x}, t),  \\&amp; \mathbf{u}(\mathbf{x}, 0)=\mathbf{u}_{i n}(\mathbf{x}), \\&amp; \int_{\Omega} p=0 , \\&amp; R(0)=\left(C_0+\int_{\Omega} \frac{1}{2}\left|\mathbf{u}_{in}\right|^2\right)^{\frac{1}{2}}.\end{aligned}\]</span> 时间离散后，完整的方程组可以写成 <span class="math display">\[\begin{aligned}&amp; \frac{\gamma_0 \mathbf{u}^{n+1}-\hat{\mathbf{u}}}{\Deltat}+\frac{R^{n+1}}{\sqrt{E^{n+1}}}\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)+\nabla p^{n+1}-v\nabla^2 \mathbf{u}^{n+1}=\mathbf{f}^{n+1} \\&amp; \nabla \cdot \mathbf{u}^{n+1}=0 \\&amp; 2 R^{n+1} \frac{\gamma_0 R^{n+1}-\hat{R}}{\Deltat}=\int_{\Omega}\left[\frac{\gamma_0\mathbf{u}^{n+1}-\hat{\mathbf{u}}}{\Deltat}+\frac{R^{n+1}}{\sqrt{E^{n+1}}}\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)\right] \cdot\mathbf{u}^{n+1}-\int_{\partial \Omega}\left(\mathbf{n} \cdot\mathbf{u}^{n+1}\right) \frac{1}{2}\left|\mathbf{u}^{n+1}\right|^2, \\&amp; \mathbf{u}^{n+1}=\mathbf{w}^{n+1}, \quad \text { on } \partial\Omega \\&amp; E^{n+1}=\int_{\Omega}\frac{1}{2}\left|\mathbf{u}^{n+1}\right|^2+C_0 \\&amp; \int p^{n+1}=0\end{aligned}\]</span></p><h3 id="求解步骤">求解步骤</h3><p>首先从动量方程出发依次推导 <span class="math display">\[\frac{\gamma_0 \mathbf{u}^{n+1}-\hat{\mathbf{u}}}{\Deltat}+\frac{R^{n+1}}{\sqrt{E^{n+1}}}\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)+\nabla p^{n+1}-\nu\nabla^2 \mathbf{u}^{n+1}=\mathbf{f}^{n+1}\]</span></p><p><span class="math display">\[\frac{\gamma_0}{\Delta t} \mathbf{u}^{n+1}+\nabla p^{n+1}-\nu \nabla^2\mathbf{u}^{n+1}=\mathbf{G}^{n+1}-S\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)\tag{10}\]</span></p><p><span class="math display">\[\frac{\gamma_0}{\Delta t} \mathbf{u}^{n+1}+\nablap^{n+1}=\mathbf{G}^{n+1}-S\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)-\nu \nabla \times\nabla \times \mathbf{u}^{n+1}\]</span></p><p><span class="math display">\[\int_{\Omega} \nabla p^{n+1} \cdot \nablaq=\int_{\Omega}\left[\mathbf{G}^{n+1}-S\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)\right] \cdot \nablaq-v \int_{\partial \Omega} \mathbf{n} \times \boldsymbol{\omega}^{n+1}\cdot \nabla q-\frac{\gamma_0}{\Delta t} \int_{\partial \Omega}\mathbf{n} \cdot \mathbf{w}^{n+1} q, \quad \forall q,\tag{11}\]</span></p><figure><img data-src="https://githubimages.pengfeima.cn/images/image-20240721175427494.png"alt="image-20240721175427494" /><figcaption aria-hidden="true">image-20240721175427494</figcaption></figure><blockquote><p>表达式 <spanclass="math inline">\(\overline{\boldsymbol{\omega}}^{n+1}=\nabla \times\overline{\mathbf{u}}^{n+1}\)</span>为采用了显式逼近涡量，这一项涉及边界上的空间导数，无法直接通过Dirichlet边界条件计算出来。这样做会降低数值格式的稳定性，但是显著简化了数值计算的复杂度，降低了大量计算。</p></blockquote><h4 id="求解步骤-1">求解步骤</h4><h5 id="求解p1和p2">求解p1和p2</h5><p>将<span class="math inline">\(p^{n+1}=p_1^{n+1}+S p_2^{n+1}\)</span>代入方程(11)，分离出含有S得项和不含S的项。 <span class="math display">\[\begin{gathered}\int_{\Omega} \nabla p_1^{n+1} \cdot \nabla q=\int_{\Omega}\mathbf{G}^{n+1} \cdot \nabla q-\nu \int_{\partial \Omega} \mathbf{n}\times \overline{\boldsymbol{\omega}}^{n+1} \cdot \nablaq-\frac{\gamma_0}{\Delta t} \int_{\partial \Omega} \mathbf{n} \cdot\mathbf{w}^{n+1} q, \quad \forall q ,\end{gathered}\]</span></p><p><span class="math display">\[\int_{\Omega} \nabla p_2^{n+1} \cdot \nabla q=-\int_{\Omega}\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right) \cdot \nabla q, \quad\forall q.\]</span></p><h5 id="求解u1和u2">求解u1和u2</h5><p><img data-src="https://githubimages.pengfeima.cn/images/image-20240721180538703.png" />首先对方程(10)进行分解，得到方程(15) <span class="math display">\[\frac{\gamma_0}{\nu \Delta t} \int_{\Omega} \mathbf{u}^{n+1}\varphi+\int_{\Omega} \nabla \varphi \cdot \nabla\mathbf{u}^{n+1}=\frac{1}{v} \int_{\Omega}\left(\mathbf{G}^{n+1}-\nablap_1^{n+1}\right) \varphi-\frac{S}{v}\int_{\Omega}\left[\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)+\nablap_2^{n+1}\right] \varphi\tag{15}\]</span></p><p>将<span class="math inline">\(\mathbf{u}^{n+1}=\mathbf{u}_1^{n+1}+S\mathbf{u}_2^{n+1}\)</span>代入方程，再进行同类项的合并，可得到 <spanclass="math display">\[\frac{\gamma_0}{v \Delta t} \int_{\Omega} \mathbf{u}_1^{n+1}\varphi+\int_{\Omega} \nabla \varphi \cdot \nabla\mathbf{u}_1^{n+1}=\frac{1}{v}\int_{\Omega}\left(\mathbf{G}^{n+1}-\nabla p_1^{n+1}\right) \varphi,\quad \forall  \left.\varphi\right|_{\partial \Omega}=0 \text {. }\]</span> <spanclass="math inline">\(\mathbf{u}_1^{n+1}=\mathbf{w}^{n+1},\quad\)</span> <span class="math display">\[\frac{\gamma_0}{v \Delta t} \int_{\Omega} \mathbf{u}_2^{n+1}\varphi+\int_{\Omega} \nabla \varphi \cdot \nabla\mathbf{u}_2^{n+1}=-\frac{1}{\nu}\int_{\Omega}\left[\mathbf{N}\left(\overline{\mathbf{u}}^{n+1}\right)+\nablap_2^{n+1}\right] \varphi, \quad \forall \varphi|_{\partial \Omega}=0\]</span> <span class="math inline">\(\left.\varphi\right|_{\partial\Omega}=0\)</span></p><p><span class="math inline">\(\mathbf{u}_2^{n+1}=0, \quad\)</span> on<span class="math inline">\(\partial \Omega\)</span>.</p><h4 id="计算辅助变量">计算辅助变量</h4><p><span class="math display">\[F(S)=\frac{2 \gamma_0}{\Delta t} S^3 E(S)-\frac{2 \hat{R}}{\Delta t} S^2\sqrt{E(S)}+B_0 S+B_1 S^2+B_2 S^3=0\]</span></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;SAV</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>风雷软件安装</title>
    <link href="https://www.pengfeima.cn/posts/15933/"/>
    <id>https://www.pengfeima.cn/posts/15933/</id>
    <published>2024-07-18T03:27:16.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>安装过程参照了《风雷软件应用与开发指南2406.v1217》的附录A中的教程(南航高宜胜)，能够成功安装2206版。2406版因为mgrid没有编译成功，安装失败。</p><span id="more"></span><h3 id="风雷版本">风雷版本</h3><pre class="language-bash" data-language="bash"><code class="language-bash">4331c1b45a22498aed2cb906ed82b675df702c85 <span class="token comment"># 2406版本，安装失败，mgrid未编译成功</span>907f6ddd4d6093a2c472dc4632b29b0f6fbc4c3c <span class="token comment"># 2206版本，安装成功</span></code></pre><h3 id="安装环境">安装环境</h3><p>设备为MacBook Air M2, 软件环境如下：</p><pre class="language-bash" data-language="bash"><code class="language-bash">pengfei@mapengfeideMacBook-Air PHengLEI % sw_versProductName:            macOSProductVersion:         <span class="token number">15.0</span>BuildVersion:           24A5289hpengfei@mapengfeideMacBook-Air PHengLEI % brew info<span class="token number">57</span> kegs, <span class="token number">50,023</span> files, <span class="token number">1</span>.7GBpengfei@mapengfeideMacBook-Air <span class="token number">2024</span> % <span class="token function">which</span> cmake/opt/homebrew/bin/cmakepengfei@mapengfeideMacBook-Air <span class="token number">2024</span> % cmake <span class="token parameter variable">--versio</span>ncmake version <span class="token number">3.30</span>.0CMake suite maintained and supported by Kitware <span class="token punctuation">(</span>kitware.com/cmake<span class="token punctuation">)</span>.pengfei@mapengfeideMacBook-Air <span class="token number">2024</span> % <span class="token function">which</span> gcc-14/opt/homebrew/bin/gcc-14pengfei@mapengfeideMacBook-Air <span class="token number">2024</span> % gcc-14 <span class="token parameter variable">-v</span>Using built-in specs.<span class="token assign-left variable">COLLECT_GCC</span><span class="token operator">=</span>gcc-14<span class="token assign-left variable">COLLECT_LTO_WRAPPER</span><span class="token operator">=</span>/opt/homebrew/Cellar/gcc/14.1.0_2/bin/<span class="token punctuation">..</span>/libexec/gcc/aarch64-apple-darwin23/14/lto-wrapperTarget: aarch64-apple-darwin23Configured with: <span class="token punctuation">..</span>/configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/opt/homebrew/opt/gcc <span class="token parameter variable">--libdir</span><span class="token operator">=</span>/opt/homebrew/opt/gcc/lib/gcc/current --disable-nls --enable-checking<span class="token operator">=</span>release --with-gcc-major-version-only --enable-languages<span class="token operator">=</span>c,c++,objc,obj-c++,fortran,m2 --program-suffix<span class="token operator">=</span>-14 --with-gmp<span class="token operator">=</span>/opt/homebrew/opt/gmp --with-mpfr<span class="token operator">=</span>/opt/homebrew/opt/mpfr --with-mpc<span class="token operator">=</span>/opt/homebrew/opt/libmpc --with-isl<span class="token operator">=</span>/opt/homebrew/opt/isl --with-zstd<span class="token operator">=</span>/opt/homebrew/opt/zstd --with-pkgversion<span class="token operator">=</span><span class="token string">'Homebrew GCC 14.1.0_2'</span> --with-bugurl<span class="token operator">=</span>https://github.com/Homebrew/homebrew-core/issues --with-system-zlib <span class="token parameter variable">--build</span><span class="token operator">=</span>aarch64-apple-darwin23 --with-sysroot<span class="token operator">=</span>/Library/Developer/CommandLineTools/SDKs/MacOSX14.sdkThread model: posixSupported LTO compression algorithms: zlib zstdgcc version <span class="token number">14.1</span>.0 <span class="token punctuation">(</span>Homebrew GCC <span class="token number">14.1</span>.0_2<span class="token punctuation">)</span> pengfei@mapengfeideMacBook-Air <span class="token number">2024</span> % </code></pre><h3 id="第三方库">第三方库</h3><p>风雷仓库包含了除openmpi以外的第三方库。我没有使用git拉取代码，而是使用了GitHubDesktop，代码位于<code>$HOME/GitHub</code>。后面频繁使用这个变量，索性将它写入环境变量。</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"export PHENGLEI=<span class="token environment constant">$HOME</span>/GitHub/fenglei"</span> <span class="token operator">>></span> ~/.zshrc</code></pre><h4 id="openmpi">OPENMPI</h4><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">wget</span> https://download.open-mpi.org/release/open-mpi/v4.1/openmpi-4.1.6.tar.bz2<span class="token function">tar</span> <span class="token parameter variable">-xjf</span> openmpi-4.1.6.tar.bz2<span class="token builtin class-name">cd</span> openmpi-4.1.6 <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> build <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> build<span class="token assign-left variable">CC</span><span class="token operator">=</span>gcc-14 <span class="token assign-left variable">CXX</span><span class="token operator">=</span>g++-14 <span class="token punctuation">..</span>/configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span><span class="token environment constant">$HOME</span>/pkg/openmpi-4.1.6 --enable-mpi1-compatibility --enable-static<span class="token function">make</span> <span class="token parameter variable">-j8</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span><span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"export PATH=<span class="token environment constant">$HOME</span>/pkg/openmpi-4.1.6/bin:<span class="token environment constant">$PATH</span>"</span> <span class="token operator">>></span> ~/.zshrc<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"export LD_LIBRARY_PATH=<span class="token environment constant">$HOME</span>/pkg/openmpi-4.1.6/lib:<span class="token variable">$LD_LIBRARY_PATH</span>"</span> <span class="token operator">>></span> ~/.zshrc</code></pre><p>完成openmpi的安装，将路径写入环境变量并检查。</p><pre class="language-bash" data-language="bash"><code class="language-bash">pengfei@mapengfeideMacBook-Air PHengLEI % <span class="token function">which</span> mpirun/Users/pengfei/pkg/openmpi-4.1.6/bin/mpirunpengfei@mapengfeideMacBook-Air PHengLEI % <span class="token function">which</span> mpicc/Users/pengfei/pkg/openmpi-4.1.6/bin/mpiccpengfei@mapengfeideMacBook-Air PHengLEI % <span class="token function">which</span> mpicxx/Users/pengfei/pkg/openmpi-4.1.6/bin/mpicxxpengfei@mapengfeideMacBook-Air PHengLEI % mpicxx <span class="token parameter variable">-v</span>Using built-in specs.<span class="token assign-left variable">COLLECT_GCC</span><span class="token operator">=</span>/opt/homebrew/bin/g++-14<span class="token assign-left variable">COLLECT_LTO_WRAPPER</span><span class="token operator">=</span>/opt/homebrew/Cellar/gcc/14.1.0_2/bin/<span class="token punctuation">..</span>/libexec/gcc/aarch64-apple-darwin23/14/lto-wrapperTarget: aarch64-apple-darwin23Configured with: <span class="token punctuation">..</span>/configure <span class="token parameter variable">--prefix</span><span class="token operator">=</span>/opt/homebrew/opt/gcc <span class="token parameter variable">--libdir</span><span class="token operator">=</span>/opt/homebrew/opt/gcc/lib/gcc/current --disable-nls --enable-checking<span class="token operator">=</span>release --with-gcc-major-version-only --enable-languages<span class="token operator">=</span>c,c++,objc,obj-c++,fortran,m2 --program-suffix<span class="token operator">=</span>-14 --with-gmp<span class="token operator">=</span>/opt/homebrew/opt/gmp --with-mpfr<span class="token operator">=</span>/opt/homebrew/opt/mpfr --with-mpc<span class="token operator">=</span>/opt/homebrew/opt/libmpc --with-isl<span class="token operator">=</span>/opt/homebrew/opt/isl --with-zstd<span class="token operator">=</span>/opt/homebrew/opt/zstd --with-pkgversion<span class="token operator">=</span><span class="token string">'Homebrew GCC 14.1.0_2'</span> --with-bugurl<span class="token operator">=</span>https://github.com/Homebrew/homebrew-core/issues --with-system-zlib <span class="token parameter variable">--build</span><span class="token operator">=</span>aarch64-apple-darwin23 --with-sysroot<span class="token operator">=</span>/Library/Developer/CommandLineTools/SDKs/MacOSX14.sdkThread model: posixSupported LTO compression algorithms: zlib zstdgcc version <span class="token number">14.1</span>.0 <span class="token punctuation">(</span>Homebrew GCC <span class="token number">14.1</span>.0_2<span class="token punctuation">)</span></code></pre><h4 id="hdf5">HDF5</h4><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$PHENGLEI</span>/PHengLEI/3rdparty <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> <span class="token parameter variable">-xvf</span> hdf5-1.8.8-p1.tar.gz<span class="token builtin class-name">cd</span> hdf5-1.8.8-p1 <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> build <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> lib <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> build<span class="token assign-left variable">CC</span><span class="token operator">=</span>mpicc <span class="token assign-left variable">CXX</span><span class="token operator">=</span>mpicxx <span class="token punctuation">..</span>/configure --enable-parallel --enable-largefile <span class="token parameter variable">--prefix</span><span class="token operator">=</span><span class="token variable">$PHENGLEI</span>/PHengLEI/3rdparty/hdf5-1.8.8-p1/lib --enable-static<span class="token function">make</span> <span class="token parameter variable">-j8</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span><span class="token function">cp</span> <span class="token punctuation">..</span>/lib/lib/*.a <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/Darwin-arm64<span class="token builtin class-name">cd</span> <span class="token variable">$PHENGLEI</span>/PHengLEI/3rdparty/HDF5/ <span class="token operator">&amp;&amp;</span> <span class="token function">mv</span> include include_backup<span class="token function">cp</span> <span class="token parameter variable">-r</span> <span class="token variable">$PHENGLEI</span>/PHengLEI/3rdparty/hdf5-1.8.8-p1/lib/include <span class="token builtin class-name">.</span></code></pre><h4 id="cgns">CGNS</h4><pre class="language-bash" data-language="bash"><code class="language-bash">l <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> <span class="token parameter variable">-xvf</span> cgns-3.3.0.tar.gz<span class="token builtin class-name">cd</span> CGNS-3.3.0/src <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> +x ./configure</code></pre><p>修改 <code>configure</code> 文件第 771行，加上返回类型<code>int main()&#123;return(0);&#125;</code>，否则会报错。</p><pre class="language-none"><code class="language-none">CC&#x3D;mpicc CFLAGS&#x3D;-lz .&#x2F;configure --enable-lagacy --with-mpi&#x3D;$HOME&#x2F;pkg&#x2F;openmpi-4.1.6&#x2F;bin&#x2F;mpicc --with-hdf5&#x3D;$PHENGLEI&#x2F;PHengLEI&#x2F;3rdparty&#x2F;hdf5-1.8.8-p1&#x2F;lib --prefix&#x3D;$PHENGLEI&#x2F;PHengLEI&#x2F;3rdparty&#x2F;CGNS-3.3.0&#x2F;src&#x2F;lib --enable-gcc --with-fortran&#x3D;no --disable-sharedmake -j8 &amp;&amp; make installcp .&#x2F;lib&#x2F;lib&#x2F;libcgns.a ..&#x2F;..&#x2F;Darwin-arm64</code></pre><h4 id="parmetis">ParMETIS</h4><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$PHENGLEI</span>/PHengLEI/3rdparty <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> <span class="token parameter variable">-xvf</span> parmetis-4.0.3.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> parmetis-4.0.3<span class="token function">make</span> config <span class="token assign-left variable">prefix</span><span class="token operator">=</span>.<span class="token function">make</span> <span class="token parameter variable">-j8</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">pengfei@Mas-MacBook-Air fenglei % <span class="token builtin class-name">cd</span> <span class="token variable">$PHENGLEI</span>/PHengLEI/3rdparty/Darwin-arm64pengfei@Mas-MacBook-Air Darwin-arm64 % <span class="token function">ls</span>libcgns.a       libhdf5.a       libhdf5_hl.a    libmetis.a      libparmetis.a</code></pre><h4 id="mgrid">MGRID</h4><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$PHENGLEI</span>/PHengLEI/3rdparty <span class="token operator">&amp;&amp;</span> <span class="token function">tar</span> <span class="token parameter variable">-xvf</span> mgrid-1.0.tar.gz <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> mgrid-1.0</code></pre><p>打开<code>CMakeLists.txt</code>，加入下面一行。</p><pre class="language-bash" data-language="bash"><code class="language-bash">set<span class="token punctuation">(</span>CMAKE_C_FLAGS <span class="token string">"<span class="token variable">$&#123;CMAKE_C_FLAGS&#125;</span> -Wno-implicit-function-declaration"</span><span class="token punctuation">)</span></code></pre><pre class="language-none"><code class="language-none">cd build &amp;&amp; cmake .. &amp;&amp; make</code></pre><p>遇到报错，删除<code>#include &lt;malloc.h&gt;</code>。</p><pre class="language-none"><code class="language-none">mv MGridGen&#x2F;Lib&#x2F;libmgrid.a ..&#x2F;..&#x2F;Darwin-arm64&#x2F;</code></pre><h4 id="eigen">EIGEN</h4><pre class="language-none"><code class="language-none">cd $PHENGLEI&#x2F;PHengLEI&#x2F;3rdparty &amp;&amp; tar -xvf mgrid-1.0.tar.gz</code></pre><p>2406版 将<code>Darwin-arm64</code>移动<code>liblinux</code>.</p><h3 id="安装风雷">安装风雷</h3><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token variable">$PHENGLEI</span>/PHengLEI <span class="token operator">&amp;&amp;</span>  <span class="token function">mkdir</span> build <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> buildcmake <span class="token punctuation">..</span>ccmake <span class="token punctuation">..</span></code></pre><p>在出现界面中按<code>t</code>键进入高级模式，修改以下内容： -CMAKE_CXX_COMPILER改为mpicxx的路径, - CMAKE_CXX_FLAGS改为-lz, -USE_Windows_X64改为OFF. - USE_TecplotLib改为OFF</p><p>修改后，按c键配置，按e键退出，再按g键生成相关的编译配置文件。可能需要重复多次才能修改成功。最后，编译，运行。</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> <span class="token parameter variable">-j8</span><span class="token builtin class-name">cd</span> PHengLEIv3d0 <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-r</span> bin grid<span class="token function">mv</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/examples/bin <span class="token builtin class-name">.</span><span class="token function">mv</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/examples/grid <span class="token builtin class-name">.</span>./PHengLEIv3d0</code></pre>]]></content>
    
    
    <summary type="html">&lt;p&gt;安装过程参照了《风雷软件应用与开发指南2406.v1217》的附录A中的教程(南航高宜胜)，能够成功安装2206版。2406版因为mgrid没有编译成功，安装失败。&lt;/p&gt;</summary>
    
    
    
    <category term="科研" scheme="https://www.pengfeima.cn/categories/research/"/>
    
    
    <category term="风雷" scheme="https://www.pengfeima.cn/tags/%E9%A3%8E%E9%9B%B7/"/>
    
    <category term="CFD" scheme="https://www.pengfeima.cn/tags/CFD/"/>
    
  </entry>
  
  <entry>
    <title>SAV 方法求解流固耦合问题(一)</title>
    <link href="https://www.pengfeima.cn/posts/48079/"/>
    <id>https://www.pengfeima.cn/posts/48079/</id>
    <published>2024-07-16T07:42:44.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>从理论上分析，SAV技术的引入可显著增强IB方法的稳定性，。然而，唯有最终的数值分析结果，才能作为最具说服力的证据。本次数值实验均在<ahref="https://github.com/shaoyaoqian/immersed_boundary_method">IB-FEniCS</a>(暂未开源)中验证。</p><p>(Lin et al., 2019)</p><p>(Li and Shen, 2020)</p><p>(Li and Shen, 2020)方法需要满足一定的边界条件，以下是我给出的算例。</p><span id="more"></span><h3 id="sav方法求解ns方程">SAV方法求解NS方程</h3><p>主要的参考文献有两篇<a href="#fn1" class="footnote-ref" id="fnref1"role="doc-noteref"><sup>1</sup></a><spanclass="math inline">\(^,\)</span><a href="#fn2" class="footnote-ref"id="fnref2"role="doc-noteref"><sup>2</sup></a>，验证稳定性的算例有两个，一个是Kovasznay 流，另一个是圆柱绕流。</p><h4 id="kovasznay-流">Kovasznay 流</h4><p>Kovasznay 流的解析解为</p><p><img data-src="https://githubimages.pengfeima.cn/images/202407161657475.svg" /></p><p>其中，<span class="math inline">\(\lambda=\frac{1}{2\nu}-\sqrt{\frac{1}{4 \nu^2}+4 \pi^2}\)</span>，<spanclass="math inline">\(\nu = 0.025\)</span>，计算区域为<spanclass="math inline">\([-0.5,1.0]\times[-0.5,0.5]\)</span>。这是一个通过非稳态方程求解的稳态问题，给定初值<spanclass="math inline">\(\mathbf{u}_0=\mathbf{0}\)</span>，源项<spanclass="math inline">\(\mathbf{f}=\mathbf{0}\)</span>，速度的 Dirichlet边界条件由解析解给定。如图所示，解析解可以表示一块挡板后面的流体运动。</p><p><img data-src="https://githubimages.pengfeima.cn/images/image-20240721223859047.png" /></p><p>论文中的数值试验主要分如下几点： ##### 空间收敛性</p><p>给定<span class="math inline">\(\Delta t = 0.005\)</span>, <spanclass="math inline">\(C_0=0.1\)</span>,网格不变，随着谱元的阶数提升，速度误差减小，直到"饱和"。饱和后，误差受到时间步长的影响不再变化。评估误差饱和之前的变化是否满足空间收敛规律。</p><h5 id="c_0对精度的影响"><spanclass="math inline">\(C_0\)</span>对精度的影响</h5><p>给定<span class="math inline">\(\Delta t = 0.005\)</span>,谱元的阶数为<span class="math inline">\(14\)</span>, 分别计算 <spanclass="math inline">\(C_0=0.1\)</span> 和 <spanclass="math inline">\(C_0=500\)</span>，比较误差的变化，时间算到了<spanclass="math inline">\(10^5s\)</span>.</p><p>计算<spanclass="math inline">\(C_0\in[10^{-4},10^{14}]\)</span>，计算达到稳态后的误差。</p><h5 id="稳定性">稳定性</h5><ol type="1"><li>考虑谱元阶数10和16，<span class="math inline">\(C_0=0.01\)</span>,<span class="math inline">\(\Delta t\in[0.001,1.0]\)</span>，发现时间步长过大，误差较大，但是数值计算仍然能够保持稳定。如果是半隐格式，步长稍微增大，数值计算就不再稳定，如下图所示。currentscheme exhibits a different behavior and produces stable computationseven with much larger <span class="math inline">\(t\)</span>values.</li></ol><p><img data-src="https://githubimages.pengfeima.cn/images/image-20240721230945788.png" /></p><ol start="2" type="1"><li>时间步长再调大，误差太大，计算结果没有意义了，但是我们的算法还能保持稳定。</li></ol><p><img data-src="https://githubimages.pengfeima.cn/images/image-20240721231158590.png" /></p><ol start="3" type="1"><li>画出不同时间步长计算出的<spanclass="math inline">\(E(t)\)</span>和<spanclass="math inline">\([R(t)]^2\)</span>的曲线，当<spanclass="math inline">\(\Delta t\)</span>很小时，两条曲线几乎相同。随着<span class="math inline">\(\Deltat\)</span>增加，两条曲线均开始出现波动，差距逐渐增加。这表明，我们提出的数值格式能自动调整<spanclass="math inline">\(\frac{R(t)}{\sqrt{E(t)}}\)</span>,显式处理非线性项，因此能使计算更加稳定。</li></ol><p>目前，首先是李晓丽的文章中的算例，计算区域为 <spanclass="math inline">\(\Omega=(0,1) \times(0,1)\)</span>,<spanclass="math inline">\(T=1\)</span>,<spanclass="math inline">\(\nu=1\)</span> , <spanclass="math inline">\(\delta=0.1\)</span>, <spanclass="math inline">\(\Delta t=h=k\)</span>. 记 <spanclass="math display">\[\left\{\begin{array}{l}\left\|e_X\right\|_{\infty, 2}=\max _{0 \leq n \leqm}\left\{\left\|e_X^n\right\|\right\}, \\\left\|e_p\right\|_{2,2}=\left(\sum_{n=0}^m \Delta t\left\|P^{n+1 /2}-p^{n+1 / 2}\right\|_{l^2, M}^2\right)^{1 / 2} \\\left\|e_q\right\|_{\infty}=\max _{0 \leq n \leq m}\left|Q^n-q^n\right|,\end{array}\right.\]</span> 其中， <span class="math inline">\(X=\mathbf{u}, d_x u_1, D_yu_1\)</span>.</p><h4 id="算例一">算例一</h4><p><span class="math display">\[\left\{\begin{array}{l}p(x, y, t)=\exp (t)\left(x^3-1 / 4\right) \\u_1(x, y, t)=-\exp (t) x^2(x-1)^2 y(y-1)(2 y-1) / 256 \\u_2(x, y, t)=\exp (t) x(x-1)(2 x-1) y^2(y-1)^2 / 256\end{array}\right.\]</span></p><h3 id="sav求解ib方程">SAV求解IB方程</h3><aside id="footnotes" class="footnotes footnotes-end-of-document"role="doc-endnotes"><hr /><ol><li id="fn1"><p>Lin L, Yang Z, Dong S. Numerical approximation ofincompressible Navier-Stokes equations based on an auxiliary energyvariable[J]. Journal of Computational Physics, Elsevier, 2019, 388:1–22.<a href="#fnref1" class="footnote-back"role="doc-backlink">↩︎</a></p></li><li id="fn2"><p>Li X, Shen J. Error Analysis of the SAV-MAC Scheme forthe Navier—Stokes Equations[J]. SIAM Journal on Numerical Analysis,2020, 58(5): 2465–2491.<a href="#fnref2" class="footnote-back"role="doc-backlink">↩︎</a></p></li></ol></aside>]]></content>
    
    
    <summary type="html">&lt;p&gt;从理论上分析，SAV技术的引入可显著增强IB方法的稳定性，。然而，唯有最终的数值分析结果，才能作为最具说服力的证据。本次数值实验均在&lt;a
href=&quot;https://github.com/shaoyaoqian/immersed_boundary_method&quot;&gt;IB-FEniCS&lt;/a&gt;(暂未开源)中验证。&lt;/p&gt;
&lt;p&gt;(Lin et al., 2019)&lt;/p&gt;
&lt;p&gt;(Li and Shen, 2020)&lt;/p&gt;
&lt;p&gt;(Li and Shen, 2020)
方法需要满足一定的边界条件，以下是我给出的算例。&lt;/p&gt;</summary>
    
    
    
    <category term="科研" scheme="https://www.pengfeima.cn/categories/research/"/>
    
    
    <category term="SAV" scheme="https://www.pengfeima.cn/tags/SAV/"/>
    
    <category term="IB" scheme="https://www.pengfeima.cn/tags/IB/"/>
    
    <category term="benchmarking" scheme="https://www.pengfeima.cn/tags/benchmarking/"/>
    
    <category term="idea" scheme="https://www.pengfeima.cn/tags/idea/"/>
    
    <category term="paper" scheme="https://www.pengfeima.cn/tags/paper/"/>
    
  </entry>
  
  <entry>
    <title>自动化集成与部署(二)</title>
    <link href="https://www.pengfeima.cn/posts/28504/"/>
    <id>https://www.pengfeima.cn/posts/28504/</id>
    <published>2024-07-14T14:20:46.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>设想一下，我们需要周期性地执行一个计算密集型任务，并且需要利用本地的计算资源。为此，我们可以向仓库添加自托管的运行器，通过将任务以文本形式提交到仓库的指定分支，触发GitHub Action来执行工作流。由于科学计算任务通常需要非常复杂的环境配置，我们可以提前构建好镜像(包括可以执行GPU程序的镜像)，通过GitHub Action拉取这些镜像并在容器中执行命令，从而省略冗长的环境配置步骤，节省时间。</p><span id="more"></span><h3 id="打包容器为镜像并上传">打包容器为镜像并上传</h3><p>在本地容器中配置好环境，停止容器，将容器打包成镜像，上传到 DockerHub. <pre class="language-none"><code class="language-none">sudo docker stop 530d5a791f5asudo docker commit 530d5a791f5a mapengfei&#x2F;npuheart:latexdocker push mapengfei&#x2F;npuheart:latexsudo docker run -it mapengfei&#x2F;npuheart:latex bash</code></pre></p><h3 id="直接构建镜像并上传">直接构建镜像并上传</h3><p>镜像直接从 Dockerfile 文件构建。 <pre class="language-none"><code class="language-none">docker rmi mapengfei&#x2F;npuheart:latexdocker tag npuheart:latest mapengfei&#x2F;npuheart:latexdocker push mapengfei&#x2F;npuheart:latexsudo docker rmi mapengfei&#x2F;npuheart:latex</code></pre></p><h3 id="在-github-action-中拉取镜像并使用">在 GitHub Action中拉取镜像并使用</h3><p>参见文档：<ahref="https://docs.github.com/zh/actions/using-jobs/running-jobs-in-a-container">在容器中运行作业</a></p><h3 id="在-github-action-中构建镜像并上传">在 GitHub Action中构建镜像并上传</h3><p>参考文件：<ahref="https://github.com/shaoyaoqian/docker-computing-images/blob/ubuntu-cuda-deal/docker-compose.yml">docker.yml</a></p><p>每次打标签都会进行一次docker镜像构建，并通过推送到 Docker Hub.</p><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Publish Docker image<span class="token key atrule">on</span><span class="token punctuation">:</span>  <span class="token key atrule">push</span><span class="token punctuation">:</span>    <span class="token key atrule">tags</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">'*'</span>  <span class="token key atrule">workflow_dispatch</span><span class="token punctuation">:</span><span class="token key atrule">jobs</span><span class="token punctuation">:</span>  <span class="token key atrule">push_to_registry</span><span class="token punctuation">:</span>    <span class="token key atrule">name</span><span class="token punctuation">:</span> Push Docker image to Docker Hub    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest    <span class="token key atrule">steps</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Check out the repo        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v4      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Log in to Docker Hub        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/login<span class="token punctuation">-</span>action@f4ef78c080cd8ba55a85445d5b36e214a81df20a        <span class="token key atrule">with</span><span class="token punctuation">:</span>          <span class="token key atrule">username</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.DOCKER_USERNAME <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>          <span class="token key atrule">password</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.DOCKER_PASSWORD <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Extract metadata (tags<span class="token punctuation">,</span> labels) for Docker        <span class="token key atrule">id</span><span class="token punctuation">:</span> meta        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/metadata<span class="token punctuation">-</span>action@9ec57ed1fcdbf14dcef7dfbe97b2010124a938b7        <span class="token key atrule">with</span><span class="token punctuation">:</span>          <span class="token key atrule">images</span><span class="token punctuation">:</span> mapengfei/npuheart      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build and push Docker image        <span class="token key atrule">uses</span><span class="token punctuation">:</span> docker/build<span class="token punctuation">-</span>push<span class="token punctuation">-</span>action@3b5e8027fcad23fda98b2e3ac259d8d67585f671        <span class="token key atrule">with</span><span class="token punctuation">:</span>          <span class="token key atrule">context</span><span class="token punctuation">:</span> .          <span class="token key atrule">file</span><span class="token punctuation">:</span> images<span class="token punctuation">-</span>latex<span class="token punctuation">-</span>newest/Dockerfile          <span class="token key atrule">push</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>          <span class="token key atrule">tags</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> steps.meta.outputs.tags <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>          <span class="token key atrule">labels</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> steps.meta.outputs.labels <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre>]]></content>
    
    
    <summary type="html">&lt;p&gt;设想一下，我们需要周期性地执行一个计算密集型任务，并且需要利用本地的计算资源。为此，我们可以向仓库添加自托管的运行器，通过将任务以文本形式提交到仓库的指定分支，触发
GitHub Action
来执行工作流。由于科学计算任务通常需要非常复杂的环境配置，我们可以提前构建好镜像(包括可以执行GPU程序的镜像)，通过
GitHub Action
拉取这些镜像并在容器中执行命令，从而省略冗长的环境配置步骤，节省时间。&lt;/p&gt;</summary>
    
    
    
    <category term="自动化" scheme="https://www.pengfeima.cn/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    
    <category term="GitHub Action" scheme="https://www.pengfeima.cn/tags/GitHub-Action/"/>
    
    <category term="docker" scheme="https://www.pengfeima.cn/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>自动化集成与部署(一)</title>
    <link href="https://www.pengfeima.cn/posts/23882/"/>
    <id>https://www.pengfeima.cn/posts/23882/</id>
    <published>2024-07-14T08:59:53.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>通过Webhook连接各种计算资源完成任务。</p><ul><li>CI: 持续集成（Continuous Integration）</li><li>CD: 持续交付/持续部署（Continuous Delivery/ContinuousDeployment）</li></ul><span id="more"></span><p>每次修改代码后，IB-FEniCS通过GitHubAction自动完成编译、测试，发送消息给n8n，由n8n引导各项工作。</p><h3 id="n8n">1. n8n</h3><p>在 n8n 放置一个 Webhook节点监听HTTP请求，一旦接收到以POST方式发送过来的请求便触发接下来的工作流。</p><figure><img data-src="https://githubimages.pengfeima.cn/images/202407141745176.png"alt="Webhook 节点" /><figcaption aria-hidden="true">Webhook 节点</figcaption></figure><figure><img data-src="https://githubimages.pengfeima.cn/images/202407141707614.png"alt="Webhook 节点的设置" /><figcaption aria-hidden="true">Webhook 节点的设置</figcaption></figure><h3 id="github">2. GitHub</h3><p>在GitHub设置触发Webhook的条件，GitHub仓库的任何动作都会触发发送HTTP请求。例如：创建了一个issue，n8n那里就会收到信号，执行后续工作流程。 <img data-src="https://githubimages.pengfeima.cn/images/202407141707808.png"alt="GitHub Webhook" /></p><figure><img data-src="https://githubimages.pengfeima.cn/images/202407141706496.png"alt="GitHub Issue" /><figcaption aria-hidden="true">GitHub Issue</figcaption></figure><figure><img data-src="https://githubimages.pengfeima.cn/images/202407141706736.png"alt="已经发送的请求" /><figcaption aria-hidden="true">已经发送的请求</figcaption></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;通过Webhook连接各种计算资源完成任务。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CI: 持续集成（Continuous Integration）&lt;/li&gt;
&lt;li&gt;CD: 持续交付/持续部署（Continuous Delivery/Continuous
Deployment）&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="自动化" scheme="https://www.pengfeima.cn/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    
    <category term="GitHub Action" scheme="https://www.pengfeima.cn/tags/GitHub-Action/"/>
    
    <category term="n8n" scheme="https://www.pengfeima.cn/tags/n8n/"/>
    
    <category term="serverless" scheme="https://www.pengfeima.cn/tags/serverless/"/>
    
  </entry>
  
  <entry>
    <title>直管二尖瓣模拟日志(二)</title>
    <link href="https://www.pengfeima.cn/posts/59583/"/>
    <id>https://www.pengfeima.cn/posts/59583/</id>
    <published>2024-07-06T07:33:00.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>第二部分。</p><span id="more"></span><h2 id="月6日">7月6日</h2><ul class="task-list"><li><label><input type="checkbox" />直管网格壁面厚度为 <spanclass="math inline">\(0.25\text{cm}\)</span> , 直管外环半径为 <spanclass="math inline">\(4.05\text{cm}\)</span>.</label></li><li><label><input type="checkbox" />将网格移动到 Git Large FileStorage.</label></li></ul><h4 id="git-lfs-的用法">GIT LFS 的用法</h4><p>网格文件过大，准备存储到GitHub上(GitHub LFS存储限额为1GB，存储大模型的魔塔社区和Huggingface提供无限量的存储空间，遂将数据仓库从GitHub仓库迁移到了魔塔社区)。</p><ol type="1"><li>跟踪</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> lfs track <span class="token string">"*.h5"</span><span class="token function">git</span> lfs track <span class="token string">"*.xdmf"</span><span class="token function">git</span> lfs track <span class="token string">"*.vtu"</span><span class="token function">git</span> lfs track <span class="token string">"*.pvd"</span><span class="token function">git</span> lfs track <span class="token string">"*.xml"</span></code></pre><ol start="2" type="1"><li>添加文件</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre><ol start="3" type="1"><li>上传</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">"add file.psd"</span><span class="token function">git</span> push</code></pre><ol start="4" type="1"><li>拉取</li></ol><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> lfs fetch<span class="token function">git</span> lfs checkout</code></pre><figure><img data-src="https://githubimages.pengfeima.cn/images/202407061558489.png"alt="上传到 Git Large File Storage" /><figcaption aria-hidden="true">上传到 Git Large FileStorage</figcaption></figure><figure><img data-src="https://githubimages.pengfeima.cn/images/202407061600054.png"alt="免费额度" /><figcaption aria-hidden="true">免费额度</figcaption></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;第二部分。&lt;/p&gt;</summary>
    
    
    
    <category term="科研" scheme="https://www.pengfeima.cn/categories/research/"/>
    
    
  </entry>
  
  <entry>
    <title>直管二尖瓣模拟日志</title>
    <link href="https://www.pengfeima.cn/posts/21745/"/>
    <id>https://www.pengfeima.cn/posts/21745/</id>
    <published>2024-05-04T08:07:29.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>将直管二尖瓣模型模拟缺血性返流的研究作为第二篇文章。</p><span id="more"></span><ol type="1"><li><p>瓣膜打开状态可以正确模拟。 <div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202405041611537.png"alt="0.0601s" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202405041611514.png"alt="0.1001s" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202405041611522.png"alt="0.1401s" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202405041611707.png"alt="0.1851s" /></div></div></div></p></li><li><p>0.185秒，瓣膜开始闭合，需在出口处对流体施加反馈力，阻止流体流动。</p><p>有如下问题：</p><ol type="1"><li>时间步长缩小为原来的1/10。</li><li>如果直管外也施加反馈力，那么程序只能运行到0.06s。</li></ol></li></ol><p>在出口处设置反馈力可以使速度下降。</p><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202405071059114.png" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202405071059878.png" /></div></div></div><p>5月11日-5月15日</p><p>程序上没有什么改动。</p><h3 id="月23日-生成二尖瓣环扩张的网格">5月23日生成二尖瓣环扩张的网格</h3><p>生成MV网格的过程比较复杂, 分为两轮。</p><h4 id="第一轮程序的前缀为数字">第一轮(程序的前缀为数字)</h4><ol type="1"><li>运行 <code>1_read_mesh.py</code> 生成 <code>boundaries.xml</code><code>material.xml</code> <code>mesh.xdmf</code><code>mesh.h5</code>文件。</li><li>运行 <code>2_read_fibers.p</code> 生成 <code>fiblers_0.xml</code><code>fiblers_1.xml</code> <code>fiblers_2.xml</code></li><li>运行 <code>3_remark_mesh.py</code> 生成<code>materials_remarked.xml</code><code>boundaries_remarked.xml</code>,这一步主要是区分出前后乳头肌。</li><li>运行 <code>_f_4_scale_mesh.py</code> 生成<code>mesh_scale.xdmf</code> 和 <code>mesh_scale.h5</code>,这里报错不用管，因为<code>mesh_connected.xdmf不存在</code>。</li><li>运行 <code>fsi_real_MV_dilation</code> 模拟二尖瓣环的扩张。</li></ol><h4 id="第二轮程序的前缀为字母">第二轮(程序的前缀为字母)</h4><p>在运行程序 <code>fsi_real_MV_dilation</code> 后生成了<code>process.xdmf</code> 文件, 文件中保存着瓣膜的位移信息。 1. 运行<code>_a_modify_mesh.py</code> , 生成 <code>mesh_dilation.xdmf</code>文件, 为扩张后的二尖瓣(仅有瓣膜叶和腱索)。 2. 运行<code>_b_identify_boundary.py</code>, 提取出瓣膜叶边缘的坐标。 3. 运行<code>c_generate_disk.py</code>, 生成圆盘。 4. 运行<code>d_generate_tube.py</code>, 生成直管。 5. 运行<code>e_connect_meshes.py</code>, 连接网格,<code>fibers_0_connected.xml</code>,<code>materials_connected.xml</code>,<code>mesh_connected</code>.xdmf,boundaries_connected.xml 6. 运行 <code>_f_4_scale_mesh.py</code> 生成<code>mesh_connected_scale.xdmf</code> 和<code>mesh_connected_scale.h5</code>网格。</p><h3 id="月24日-调慢二尖瓣环扩张的速度">5月24日调慢二尖瓣环扩张的速度</h3><p>调慢不起作用</p><h3 id="月25日-重新npuheart的环境">5月25日 重新NPUHeart的环境</h3><p>遇到一个无法解决的错误，可能是mpi的问题，也可能是网格的问题，希望通过重新配置环境，排除运行环境的问题，此版本移除了openmp的依赖，并且不指定固定版本的openmpi。</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">https_proxy</span><span class="token operator">=</span>http://127.0.0.1:7890 <span class="token assign-left variable">http_proxy</span><span class="token operator">=</span>http://127.0.0.1:7890 <span class="token assign-left variable">all_proxy</span><span class="token operator">=</span>socks5://127.0.0.1:7890<span class="token function">git</span> clone <span class="token parameter variable">-c</span> <span class="token assign-left variable">feature.manyFiles</span><span class="token operator">=</span>true https://github.com/spack/spack.git<span class="token function">git</span> clone git@github.com:npuheart/npuheart.git<span class="token function">scp</span> <span class="token parameter variable">-r</span> kokkos@127.0.0.1:~/spack/var/spack/cache ~/spack/var/spack/<span class="token builtin class-name">.</span> ~/spack/share/spack/setup-env.shspack compiler <span class="token function">find</span>spack <span class="token function">install</span> gcc@11.4.0spack load gccspack compiler <span class="token function">find</span>spack <span class="token function">env</span> create fenics_kokkosspack <span class="token function">env</span> activate fenics_kokkos <span class="token parameter variable">-p</span>code ~/spack/var/spack/environments/fenics_kokkos/spack.yaml <span class="token comment"># 复制下面内容</span>spack concretize <span class="token parameter variable">-f</span>spack <span class="token function">install</span></code></pre><pre class="language-yaml" data-language="yaml"><code class="language-yaml"><span class="token comment"># NOTE: 此版本移除了openmp的依赖，并且不指定固定版本的openmpi</span><span class="token comment"># 通过 gcc@11.4.0 能够编译成功</span><span class="token key atrule">spack</span><span class="token punctuation">:</span>  <span class="token key atrule">specs</span><span class="token punctuation">:</span>  <span class="token comment"># - cuda@12.2.1 +allow-unsupported-compilers # V12.3.52</span>  <span class="token punctuation">-</span> kokkos<span class="token punctuation">-</span>kernels@master +cuda cuda_arch=89 %gcc@11.4.0  <span class="token punctuation">-</span> kokkos@master +cuda +cuda_lambda +cuda_constexpr +wrapper cuda_arch=89 cxxstd=20  <span class="token comment"># FEniCS</span>  <span class="token punctuation">-</span> fenics@2019.1.0.post0 +zlib build_type=Release cflags="<span class="token punctuation">-</span>O3"   <span class="token punctuation">-</span> petsc@3.14.0 +mumps +hdf5  <span class="token punctuation">-</span> boost@1.71.0  <span class="token punctuation">-</span> python@3.10.10 +optimizations  <span class="token punctuation">-</span> py<span class="token punctuation">-</span>matplotlib  <span class="token comment"># NPUHeart</span>  <span class="token punctuation">-</span> muparser <span class="token comment"># 2.3.4</span>  <span class="token punctuation">-</span> fmt@10.1.1  <span class="token punctuation">-</span> nlohmann<span class="token punctuation">-</span>json@3.11.2  <span class="token key atrule">view</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">concretizer</span><span class="token punctuation">:</span>    <span class="token key atrule">unify</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token key atrule">packages</span><span class="token punctuation">:</span>    <span class="token key atrule">all</span><span class="token punctuation">:</span>      <span class="token key atrule">compiler</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>gcc@11.4.0<span class="token punctuation">]</span></code></pre><blockquote><p>注意：FEniCS 依赖 suite-sparse@5.13.0 ，spack安装默认版本suite-sparse@7.3.1 时出错。</p></blockquote><h3 id="月28日">5月28日</h3><h5 id="重新计算二尖瓣环扩张后的网格">重新计算二尖瓣环扩张后的网格</h5><ol type="1"><li>当时间步为20000的时候，t=0.045时程序中断，半径大约扩大了0.24cm，程序终中断了。</li></ol><p><img data-src="https://githubimages.pengfeima.cn/images/202405280035858.jpg" alt="Xnip2024-05-28_00-34-53" style="zoom:25%;" /></p><ul class="task-list"><li><p><label><input type="checkbox"checked="" />为控制的扩张时间为t_start_closing，因此，需要在输入参数中增加该参数，从0.185调到0.5，让流体速度尽可能小。</label></p></li><li><p><label><input type="checkbox"checked="" />现在我需要跑不同的程序，半径扩大范围<spanclass="math inline">\(\{0.1,0.2,0.3,0.4,0.5\}\)</span>，输入参数中也应增加该参数。</label></p></li><li><p><label><input type="checkbox"checked="" />输出路径包含上述两个参数。</label></p></li></ul><h5 id="二尖瓣的程序需要进行如下微调">二尖瓣的程序需要进行如下微调</h5><ul class="task-list"><li><label><input type="checkbox"checked="" />前、后乳头肌的位移需要作为参数</label></li><li><label><input type="checkbox"checked="" />扩张后的网格存储在不同的文件中，文件名作为参数</label></li><li><label><input type="checkbox"checked="" />需要一个脚本，批量输出配置文件，并自动运行程序的执行命令</label></li><li><label><input type="checkbox"checked="" />json文件作为读入参数</label></li><li><label><input type="checkbox" />计算流量</label></li><li><label><inputtype="checkbox" />将material输出到view.xdmf中</label></li></ul><h5 id="二尖瓣环扩张的运行结果">二尖瓣环扩张的运行结果</h5><ul><li><p>t_start_closing=0.185 好像可以算扩张半径0.1和0.2的问题。</p></li><li><p>t_start_closing=0.3 时，可以扩张到 0.24504999999998117</p></li><li><p>t_start_closing=0.6 时，可以扩张到 0.2437749999999772</p><p>所以，要让扩张半径为 0.3 ，最重要的参数应该是时间步长。</p></li></ul><p><img data-src="https://githubimages.pengfeima.cn/images/202405291715598.png" alt="image-20240529171555443" style="zoom:25%;" /></p><h3 id="月29日">5月29日</h3><ul class="task-list"><li><label><inputtype="checkbox" />增加算例，二尖瓣环的扩张时乳头肌不固定</label></li></ul><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /home/kokkos/ssh/npuheart/build_mvpython3 batch_running.py <span class="token builtin class-name">export</span> <span class="token assign-left variable">CUDA_VISIBLE_DEVICES</span><span class="token operator">=</span><span class="token number">0</span><span class="token function">mkdir</span> log<span class="token function">mkdir</span> configtaskset <span class="token parameter variable">-c</span> <span class="token number">70</span> <span class="token function">nohup</span> ./test/fsi_real_MV_tube config/test70.json <span class="token operator">></span> log/MV70.out <span class="token operator">&amp;</span>taskset <span class="token parameter variable">-c</span> <span class="token number">71</span> <span class="token function">nohup</span> ./test/fsi_real_MV_tube config/test71.json <span class="token operator">></span> log/MV71.out <span class="token operator">&amp;</span>taskset <span class="token parameter variable">-c</span> <span class="token number">72</span> <span class="token function">nohup</span> ./test/fsi_real_MV_tube config/test72.json <span class="token operator">></span> log/MV72.out <span class="token operator">&amp;</span>taskset <span class="token parameter variable">-c</span> <span class="token number">73</span> <span class="token function">nohup</span> ./test/fsi_real_MV_tube config/test73.json <span class="token operator">></span> log/MV73.out <span class="token operator">&amp;</span>taskset <span class="token parameter variable">-c</span> <span class="token number">74</span> <span class="token function">nohup</span> ./test/fsi_real_MV_tube config/test74.json <span class="token operator">></span> log/MV74.out <span class="token operator">&amp;</span>taskset <span class="token parameter variable">-c</span> <span class="token number">75</span> <span class="token function">nohup</span> ./test/fsi_real_MV_tube config/test75.json <span class="token operator">></span> log/MV75.out <span class="token operator">&amp;</span></code></pre><h3 id="月27日">6月27日</h3><h4 id="准备好了五组网格数据">准备好了五组网格数据</h4><p>数据下载：https://pan.quark.cn/s/6d98de8b7740</p><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271139599.jpeg"alt="0.0" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271138113.jpeg"alt="0.1" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271138114.jpeg"alt="0.2" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271139132.jpeg"alt="0.3" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271138101.jpeg"alt="0.4" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271139036.jpeg"alt="0.5" /></div></div></div><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271154989.jpeg"alt="0.1_tube" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271154976.jpeg"alt="0.2_tube" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271154827.jpeg"alt="0.3_tube" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271154960.jpeg"alt="0.4_tube" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202406271154981.jpeg"alt="0.5_tube" /></div></div></div>]]></content>
    
    
    <summary type="html">&lt;p&gt;将直管二尖瓣模型模拟缺血性返流的研究作为第二篇文章。&lt;/p&gt;</summary>
    
    
    
    <category term="科研" scheme="https://www.pengfeima.cn/categories/research/"/>
    
    
  </entry>
  
  <entry>
    <title>网站收集</title>
    <link href="https://www.pengfeima.cn/posts/49572/"/>
    <id>https://www.pengfeima.cn/posts/49572/</id>
    <published>2024-04-06T04:28:56.000Z</published>
    <updated>2025-01-26T08:00:29.762Z</updated>
    
    <content type="html"><![CDATA[<p>我平时收集的一些网站。</p><span id="more"></span><iframe src="https://wangxuan.mapengfei.cn/web" width="800" height="5000" frameborder="0"></iframe><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://wangxuan.mapengfei.cn/web<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>800<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>5000<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span></code></pre>]]></content>
    
    
    <summary type="html">&lt;p&gt;我平时收集的一些网站。&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>2023年十一月上旬科研日志</title>
    <link href="https://www.pengfeima.cn/posts/10083/"/>
    <id>https://www.pengfeima.cn/posts/10083/</id>
    <published>2023-11-06T03:42:40.000Z</published>
    <updated>2025-01-26T08:00:29.761Z</updated>
    
    <content type="html"><![CDATA[<p>十一月份最主要的任务是完成第一篇文章的初稿。 <span id="more"></span> ##2023-11-06 11:54</p><h3 id="暂时先用-lbfgs-方法求解非线性问题">暂时先用 LBFGS方法求解非线性问题</h3><p>用下面的运算符重载来表达残差公式<code>Y = X - _solid_displacement - dt * U</code>的计算。此函数需要返回两个对象，一个是grad，一个目标函数 <spanclass="math inline">\(f=\|\mathbf{Y}\|_2\)</span> 。需要注意的是，<spanclass="math inline">\(f\)</span> 关于 <spanclass="math inline">\(\mathbf{X}\)</span> 的导数并不是 <spanclass="math inline">\(\mathbf{Y}\)</span> 。</p><pre class="language-C++" data-language="C++"><code class="language-C++">double operator()(const Eigen::VectorXd &amp;x, Eigen::VectorXd &amp;grad)</code></pre><p>在这个函数内部需要完成以下这些事情 1. 将 x 转换成<code>std::vector&lt;double3&gt;</code> 类型 2. 调用<code>calculate_solid_velocity(X, U);</code> 3.<code>Y = X - _solid_displacement - dt * U;</code> 4. 将 Y 转换回<code>Eigen::VectorXd</code> 类型 5. 计算 Y 的二范数</p><h3 id="下载-lbfgspp-代码">下载 LBFGSpp 代码</h3><p>lbfgspp是一个仅有头文件的库，它依赖Eigen。因为我们的dolfin等库已经使用了eigen，因此没必要再在lbfgspp中再使用一次Eigen。因此需要在cmake文件中注释掉下面几行代码。</p><pre class="language-cmake" data-language="cmake"><code class="language-cmake"><span class="token keyword">find_package</span><span class="token punctuation">(</span>Eigen3 <span class="token number">3.0</span> REQUIRED<span class="token punctuation">)</span><span class="token keyword">target_link_libraries</span><span class="token punctuation">(</span>lbfgspp <span class="token namespace">INTERFACE</span> <span class="token inserted class-name">Eigen3::Eigen</span><span class="token punctuation">)</span><span class="token keyword">message</span><span class="token punctuation">(</span><span class="token string">"-- Eigen3 version: "</span> <span class="token punctuation">$&#123;</span>EIGEN3_VERSION_STRING<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></code></pre><h2 id="中午休息">2023-11-06 12:31 中午休息</h2><h2 id="section">2023-11-06 13:46</h2><h3 id="查看理想左心室舒张算例结果">查看理想左心室舒张算例结果</h3><p>程序中断了，查看结果发现</p><h3 id="左心室算例">左心室算例</h3><p>显格式的真实左心室和理想左心室舒张都重新放上去跑了。理想左心室还未跑到终止时刻程序就断了。和论文中结果进行比较，论文中心室在中轴线上的中点的位置为-26.5--27.5之间，在参数还未调对之前，我算出来的位移为0.72左右，换算一下为30.7左右，因此，未达到稳定状态时，心室的膨胀程度比论文中的结果大。需要继续运行程序，等程序几乎达到稳定状态再看结果。此外，还需要缩小时间步长，增大顶端的固定系数。</p><figure><img data-src="https://githubimages.pengfeima.cn/images/202311071601927.png"alt="image-20231107160116830" /><figcaption aria-hidden="true">image-20231107160116830</figcaption></figure><p><img data-src="https://githubimages.pengfeima.cn/images/202311071558615.png" alt="image-20231107155840478" style="zoom:33%;" /></p><p>真实左心室形变后变得非常粗糙，因为误差太大导致的。主要有两个原因：</p><ol type="1"><li>时间不长太大导致不稳定</li><li>流体网格步长太大导致误差太大</li></ol><h2 id="周汇报">2023-11-08 16:00 周汇报</h2><h3 id="近期数值模拟结果">近期数值模拟结果</h3><h4 id="真实左心室">真实左心室</h4><p>真实左心室的拟静态模拟，先整体膨胀，后心尖收缩，再膨胀，如此反复。<div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081603636.jpg"alt="0.00s" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081604526.jpg"alt="0.38s" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081604113.jpg"alt="1.18s" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081604493.jpg"alt="1.41s" /></div></div></div></p><h4 id="理想左心室">理想左心室</h4><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081618765.png" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081615884.png" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081616160.png" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311081617795.png" /></div></div></div><h4 id="直杆模拟">直杆模拟</h4><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311011410159.png" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311011414694.png" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311011408664.png" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311011408083.png" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311011402038.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311011401933.jpg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202311011400437.jpg" /></div></div></div><h2 id="section-1">2023-11-13 18:45</h2><h3 id="近期任务">近期任务</h3><ol start="0" type="1"><li>直杆弯曲的算例(时间步长0.001)<ul><li>用显格式跑100s，保存10000个数据。</li><li>用隐格式跑100s，保存10000个数据。</li></ul></li><li>真实左心室算例网格<ol type="1"><li>时间步长不够小(1/32)</li><li>背景网格的空间步长不够小(0.001s)</li><li>还未达到稳态(10s)</li></ol></li><li>理想左心室的几何形状有问题，应当选取椭球更长的那半截</li><li>二维理想弹性圆环的算例<ol type="1"><li>计算能量</li><li>计算压强p的收敛阶(需要考虑流体网格、固体网格、时间不长三者)</li><li>计算速度u的收敛阶(速度应该为零)</li><li>要不要考虑椭圆形？</li></ol></li><li>将箱型迭代法考虑进心肌灌注问题的求解</li><li>三维流体的优化(未来一两周的规划)<ol type="1"><li>多重网格</li><li>重写 GPU 加速</li></ol></li><li>二维算例代码重构<ol type="1"><li>二维流体求解器应当独立出来</li><li>流体数据的输出应当统一起来</li><li>在看了压强的结果之后，计算压强的误差</li><li>ibm 也应该独立出来</li></ol></li></ol><h2 id="boxsmothing">2023-11-13 16:11 BOXSMOTHING</h2><p>稳态stokes方程的求解结果<a href="#fn1" class="footnote-ref"id="fnref1"role="doc-noteref"><sup>1</sup></a>和非稳态stokes方程的求解结果<ahref="#fn2" class="footnote-ref" id="fnref2"role="doc-noteref"><sup>2</sup></a>作为标准验证流体求解器是否正确。被王璇骂了一顿，她觉得她自己代码是对的，为什么要注释掉！！！### 箱型迭代法为了下午的组会，我们快速地构造出了一个算例，基于方腔驱动流，顶盖外法向速度的梯度为零，压强为零。</p><aside id="footnotes" class="footnotes footnotes-end-of-document"role="doc-endnotes"><hr /><ol><liid="fn1"><p>https://gist.github.com/shaoyaoqian/664fb1ba512f802baa8a8643d8325a79<ahref="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li><liid="fn2"><p>https://gist.github.com/shaoyaoqian/c62a8014e3875967d763fd98022c7e72<ahref="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li></ol></aside>]]></content>
    
    
    <summary type="html">&lt;p&gt;十一月份最主要的任务是完成第一篇文章的初稿。</summary>
    
    
    
    <category term="科研" scheme="https://www.pengfeima.cn/categories/research/"/>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://www.pengfeima.cn/posts/1/"/>
    <id>https://www.pengfeima.cn/posts/1/</id>
    <published>2023-10-30T16:00:00.000Z</published>
    <updated>2025-01-26T08:00:29.761Z</updated>
    
    <content type="html"><![CDATA[]]></content>
    
    
      
      
    <summary type="html">
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>IB方法的时间离散格式</title>
    <link href="https://www.pengfeima.cn/posts/52922/"/>
    <id>https://www.pengfeima.cn/posts/52922/</id>
    <published>2023-10-24T14:34:00.000Z</published>
    <updated>2025-01-26T08:00:29.761Z</updated>
    
    <content type="html"><![CDATA[<p>IB方法的时间离散格式主要有 Backward Euler 格式和 Crank-Nicolson格式。</p><span id="more"></span><p><span class="math display">\[\rho(\frac{\partial\textbf{u}}{\partialt}+\textbf{u}\cdot\nabla\textbf{u})+\nablap-\mu\Delta\textbf{u}=\textbf{f}\\\nabla\cdot{\textbf{u}}=0\\\int_{B_{r}}\textbf{F}\cdot\textbf{V}d\textbf{X}=-\int_{B_{r}}\mathbb{P}:\nabla\textbf{V}d\textbf{X}\\\textbf{f}(\textbf{x},t)=\int_{B_{r}}\textbf{F}(\textbf{X},t)\delta(x-\chi(\textbf{X},t))dx\\\frac{\partial\chi(\textbf{X},t)}{\partialt}=\int_{\Omega}\textbf{u}(\textbf{x},t)\delta(\chi(\textbf{X},t)-\textbf{x})d\textbf{x}\]</span></p><h3 id="backward-euler格式">Backward Euler格式</h3><ol type="1"><li><p>利用<span class="math inline">\(\chi^{n}\)</span>，更新<spanclass="math inline">\(\mathcal{J}(\chi^{n})\)</span>和<spanclass="math inline">\(\mathcal{S}(\chi^{n})\)</span></p></li><li><p>利用FEniCS求解<spanclass="math inline">\(\textbf{F}(\chi^{n})\)</span></p></li><li><p>计算 <span class="math display">\[\textbf{f}^{n}=\mathcal{S}(\chi^{n})\textbf{F}(\chi^{n})\]</span></p></li><li><p>求解 N-S 方程，<font color=red>时间离散使用一阶格式</font> <spanclass="math display">\[\rho(\frac{\mathbf{u}^{n+1}-\mathbf{u}^{n}}{\Deltat}+\textbf{A}^{n+\frac{1}{2}})=-\nabla_{h}p^{n}+\mu\nabla^{2}_{h}\textbf{u}^{n+1}+\mathbf{f}^{n}\\\nabla_{h}\cdot \mathbf{u}^{n+1}=0\]</span></p></li><li><p>更新<span class="math inline">\(\chi^{n+1}\)</span> <spanclass="math display">\[\frac{\chi^{n+1}-\chi^{n}}{\Deltat}=\mathcal{J}(\chi^{n})\textbf{u}^{n+1}\]</span></p></li></ol><h3 id="crank-nicolson格式">Crank-Nicolson格式</h3><ol type="1"><li><p>利用<span class="math inline">\(\chi^{n}\)</span>,更新<spanclass="math inline">\(\mathcal{J}(\chi^{n})\)</span>,<spanclass="math inline">\(\mathcal{S}(\chi^{n})\)</span></p></li><li><p><font color=red>更新位移<spanclass="math inline">\(\chi^{n+\frac{1}{2}}\)</span></font></p></li></ol><p><span class="math display">\[\frac{\chi^{n+\frac{1}{2}}-\chi^{n}}{\Deltat/2}=\mathcal{J}(\chi^{n})\textbf u^{n}\]</span></p><ol start="3" type="1"><li><p>同时更新插值算子和延拓算子 <spanclass="math inline">\(\mathcal{J}(\chi^{n+\frac{1}{2}})\)</span> 和<span class="math inline">\(\mathcal{S}(\chi^{n+\frac{1}{2}})\)</span>，<strong>以此保证插值算子和延拓算子是对偶的对偶性</strong></p></li><li><p>利用FEniCs求解<spanclass="math inline">\(\textbf{F}(\chi^{n+\frac{1}{2}})\)</span> <spanclass="math display">\[\int_{B_{r}}\textbf{F}^{n+\frac{1}{2}}\cdot\textbf{V}d\textbf{X}=-\int_{B_{r}}\mathbb{P}(\textbf{X}^{n+\frac{1}{2}}):\nabla\textbf{V}d\textbf{X}\\\]</span></p></li><li><p>不需要更改，因为修改<spanclass="math inline">\(\mathcal{J}(\chi^{n+\frac{1}{2}})\)</span>后这里自动修改</p></li></ol><p><span class="math display">\[\textbf{f}^{n+\frac{1}{2}}=\mathcal{S}(\chi^{n+\frac{1}{2}})\textbf{F}(\chi^{n+\frac{1}{2}})\\\]</span></p><ol start="6" type="1"><li>求解N-S方程</li></ol><p><span class="math display">\[\rho(\frac{u^{n+1}-u^{n}}{\Deltat}+\textbf{A}^{n+\frac{1}{2}})=-\nabla_{h}p^{n+\frac{1}{2}}+\mu\nabla^{2}_{h}(\frac{\textbf{u}^{n+1}+\textbf{u}^{n}}{2})+\textbf{f}^{n+\frac{1}{2}}\\\nabla_{h}u^{n+1}=0\]</span></p><p>​ 其中<spanclass="math inline">\(\textbf{A}^{n+\frac{1}{2}}=\frac{3}{2}\textbf{u}^{n}\cdot\nabla_{h}\textbf{u}^{n}-\frac{1}{2}\textbf{u}^{n-1}\cdot\nabla_{h}\textbf{u}^{n-1}\)</span></p><ol start="7" type="1"><li>更新<span class="math inline">\(\chi^{n+1}\)</span></li></ol><p><span class="math display">\[\frac{\chi^{n+1}-\chi^{n}}{\Deltat}=\mathcal{J}(\chi^{n+\frac{1}{2}})(\frac{\textbf{u}^{n+1}+\textbf{u}^{n}}{2})\\=\frac{1}{2}(\mathcal{J}(\chi^{n+\frac{1}{2}})\textbf{u}^{n+1}+\mathcal{J}(\chi^{n+\frac{1}{2}})\textbf{u}^{n})\\=\frac{1}{2}(\textbf{U}^{n+1}+\textbf{U}^{n})\]</span></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;IB方法的时间离散格式主要有 Backward Euler 格式和 Crank-Nicolson
格式。&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>秦PLUS日常使用油电消耗统计</title>
    <link href="https://www.pengfeima.cn/posts/37773/"/>
    <id>https://www.pengfeima.cn/posts/37773/</id>
    <published>2023-08-18T00:49:21.000Z</published>
    <updated>2025-01-26T08:00:29.761Z</updated>
    
    <content type="html"><![CDATA[<div><canvas id="myChart"></canvas></div><span id="more"></span><h3 id="购车经验"><strong>购车经验</strong></h3><p>我购买的秦PLUS为 <strong>2023款 冠军版 DM-i120KM领先型</strong>，裸车价格125800元，西安造字台附近的比亚迪新景腾飞4S店购买，价格无优惠。</p><p>销售通过易车APP获取我的电话，于6月30号上午给我打电话。销售告诉我，这个月月底冲业绩，今天购车可送我八次保养，免上牌费，送底盘装甲，可当天提车。下午我和WX就去他们店里看车，结果销售说上牌费不能免。我想提车，不想再到处跑，折腾购车相关的事情，没有去其他4S店看车，就付钱提车了。</p><p>以后可能还会买车，需要注意的点： 1.贴膜。原厂送的膜质量很差，如果想换膜，可以在买车前跟销售谈换膜的价格，别贴膜的时候被忽悠到交钱了。我去贴膜的时候被告知，换成<strong>康得新膜</strong>或者<strong>龙膜</strong>要一千多，我没有掏钱，只贴了原厂送的膜。2.保险。4S店里卖保险的人介绍保险的时候，将出行险和座位险混为一谈，声称能保62万。事实上，62万中的60万属于车主的出行险，价格715元，只保车主不保乘客。销售还推荐了一个不知名的险种，能够放大赔偿金额，没必要购买。3.延保。花三千多延长保修到8年，与机械部件不同，电子元器件的故障率随着使用年限增长而降低，有问题的部件会在保修期内损坏坏，保修期内没坏的大概率能使用到汽车报废。4.价格。现在汽车价格公开透明，但8月份是汽车销售淡季，汽车的资金占用成本和库存成本很高，降价是必然的。我买的这款车并不缺现车，我提的车为三月份生产，六月底卖出，期间存放了三个多月。如果在8月18日购车，会有3000元购车优惠，950元交强险优惠。</p><p>总之，一定要有耐心，一定要把各个事项问清楚，慎重交款，交款之前主动权还是在自己这边的，交款之后再谈会很被动。交钱后发现保险和销售说的不一样，可以退保。</p><p>我决定购买这辆车时，已接受了它的缺点： 1.<strong>底盘硬</strong>，走烂路不舒服 2.在易车十万里长测中能看到，保险杠连接处会<strong>生锈</strong> 3.长城举报比亚迪没有使用<strong>高压油箱</strong>，蒸发不达标 4.<strong>EV受限</strong>，不能长期亏电行驶</p><p>以后有钱了要买安全系数高的车，非承载车身，吨位大，新，铝合金/热处理钢，防撞梁高度高，抗翻滚能力高。</p><h4 id="赠品"><strong>赠品</strong></h4><ul><li>八次保养(约¥200/次)</li><li>贴膜(约¥1000)</li><li>底盘装甲(约¥1000) 赠品总价值约为¥3600。贴膜的时候原厂贴膜可以换成<strong>康得新膜</strong>或者<strong>龙膜</strong>，抵掉原厂送的贴膜，需要加价一千多。#### <strong>其他消费</strong></li><li>上牌费(¥500)</li><li>行车记录仪(¥303)</li><li>后备箱垫(¥50<strong>还没买</strong>)</li><li>放电枪(¥333)</li><li>抱枕(¥80) 总共 ¥1783 #### <strong>保险</strong></li><li>交强险 950</li><li>车辆损失险 2600</li><li>第三方200万 950</li><li>乘客2万 55</li><li>司机2万 22</li><li>出行险 715 总共 ¥ 5361，以后可以免去或减少出行险的保额。 ####<strong>轮胎型号</strong> 原厂轮胎为<strong>佳通 215/55 R17 94VF22</strong>，换过一个轮胎，总共¥480。 补胎:蘑菇钉，60元，忘了叫他给轮胎做动平衡。 ## <strong>购物清单</strong></li></ul><ol type="1"><li><p>车载吸尘器(¥199)</p></li><li><p>无线洗车机机(¥369)</p></li><li><p>玻璃水</p></li><li><p>户外桌椅(¥104)</p></li><li><p>天幕帐篷(¥105)</p></li><li><p>防潮垫</p></li><li><p>吊床(¥39)</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;div&gt;
&lt;canvas id=&quot;myChart&quot;&gt;
&lt;/canvas&gt;
&lt;/div&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>我有一个漂亮的女朋友</title>
    <link href="https://www.pengfeima.cn/posts/42969/"/>
    <id>https://www.pengfeima.cn/posts/42969/</id>
    <published>2023-06-15T12:26:04.000Z</published>
    <updated>2025-01-26T08:00:29.761Z</updated>
    
    <content type="html"><![CDATA[<div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152025509.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024158.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024001.JPG" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024132.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024062.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024391.JPG" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024029.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024102.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024355.JPG" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024439.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024719.JPG" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024726.JPG" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152024839.JPG" /></div></div></div><p class="image-caption">大唐不夜城</p><span id="more"></span><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242612.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242589.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242666.jpg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242450.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242688.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152243274.jpg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242382.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242599.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242398.jpg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242234.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242455.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242094.jpg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152243681.jpg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306152242384.jpg" /></div></div></div><p class="image-caption">连云港</p>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;group-picture&quot;&gt;&lt;div class=&quot;group-picture-row&quot;&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152025509.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024158.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024001.JPG&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-row&quot;&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024132.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024062.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024391.JPG&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-row&quot;&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024029.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024102.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024355.JPG&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-row&quot;&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024439.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024719.JPG&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024726.JPG&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-row&quot;&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306152024839.JPG&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p class=&quot;image-caption&quot;&gt;
大唐不夜城
&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>小电驴购买记</title>
    <link href="https://www.pengfeima.cn/posts/59919/"/>
    <id>https://www.pengfeima.cn/posts/59919/</id>
    <published>2023-06-15T01:47:34.000Z</published>
    <updated>2025-01-26T08:00:29.761Z</updated>
    
    <content type="html"><![CDATA[<p>不要为想象中可能存在，但眼下尚未出现的需求埋单 <span id="more"></span></p><h1 id="电动自行车的选购">电动自行车的选购</h1><p>作为遵纪守法的好公民，购买电动自行车前最重要的是看一看相关的法律法规。法律法规中最重要的是关于<strong>电动自行车</strong>和<strong>电动摩托车</strong>的界定，电动自行车不需要摩托车牌照，也不需要摩托车驾照。</p><p><img data-src="https://githubimages.pengfeima.cn/images/202306150954262.png" style="zoom:25%;" /></p><p>其次要看电动车的续航。以身边的同学为例，徐娟花了¥600买了一辆二手电动车，花了¥450换了电池。电池容量是48伏12安时，按照她的说法，在夏天可以连续骑行15天不用充电，续航里程大约为40～50公里。</p><p>由于电动自行车的重量受到限制，铅酸蓄电池一般为48伏12安时，48伏16安时，价格约为¥1499，¥1999，续航为45公里，60公里。锂电池版本的电动自行车才能满足长续航的要求，电量最高可达48伏26安时，例如以下两款，价格分别为¥3099和¥3799。</p><figure><img data-src="https://githubimages.pengfeima.cn/images/202306151015780.png"alt="价格3099，电池容量为48伏20安时，官方给出的续航为70公里" /><figcaptionaria-hidden="true">价格3099，电池容量为48伏20安时，官方给出的续航为70公里</figcaption></figure><figure><img data-src="https://githubimages.pengfeima.cn/images/202306151015811.png"alt="价格3799，电池容量为48伏26安时，官方给出的续航为100公里" /><figcaptionaria-hidden="true">价格3799，电池容量为48伏26安时，官方给出的续航为100公里</figcaption></figure><h1 id="注册登记">注册登记</h1><p>最后是注册登记，需要先关注公众号，在公众号里预约。</p><p><img data-src="https://githubimages.pengfeima.cn/images/202306151002828.png" alt="公众号" style="zoom:25%;" /><img data-src="https://githubimages.pengfeima.cn/images/202306151044487.png" alt="收费标准" style="zoom:25%;" /><img data-src="https://githubimages.pengfeima.cn/images/202306150949631.jpg" alt="挂牌政策" style="zoom:33%;" /></p><p>我的小电驴于6月15号到货，走的是京东大件物流。那日午后，王璇正趴在桌上睡觉，我在旁边学习，忽然来了电话，物流师傅说电动车已经送到了自动化学院的后门，准备给我就地安装。我接了电话后就去找了物流师傅。</p><figure><img data-src="https://githubimages.pengfeima.cn/images/202306190108254.JPG"alt="小电驴安装" /><figcaption aria-hidden="true">小电驴安装</figcaption></figure><p>王璇上课去了，我自己去体验一下这辆电动车，我先去了一趟学校的东南角，然后友去学校西北角，顺便和常海粟一起去星H拿了一个座套。</p><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190111029.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190110579.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190110534.jpeg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190111462.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190110517.jpeg" /></div></div></div><p class="image-caption">歼轰7</p><p><img data-src="https://githubimages.pengfeima.cn/images/202306190112892.jpeg" alt="星H的猫" style="zoom: 10%;" /></p><p>买了小电驴后，最大的快乐莫过于带上女朋友去兜风。我在王璇上课的教学楼门口等她，她下来以后我门就开始逛校园。她坐在我后面，双手环抱住我的腰，小脑袋贴着我的后背。她说：“我坐我爸摩托车的时候都只是捏着我爸腰间的衣服，坐在你后面的时候就非常自然地抱着你了。“</p><p><img data-src="https://githubimages.pengfeima.cn/images/202306190114046.PNG" alt="校园足迹" style="zoom: 30%;" /></p><div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190124408.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190124209.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190124201.jpeg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190125529.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190126348.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190125517.jpeg" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190125549.jpeg" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306190126751.jpeg" /></div></div></div><p class="image-caption">启翔湖</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;不要为想象中可能存在，但眼下尚未出现的需求埋单</summary>
    
    
    
    <category term="生活" scheme="https://www.pengfeima.cn/categories/life/"/>
    
    
  </entry>
  
  <entry>
    <title>朱雀森林公园</title>
    <link href="https://www.pengfeima.cn/posts/60075/"/>
    <id>https://www.pengfeima.cn/posts/60075/</id>
    <published>2023-06-14T00:39:04.000Z</published>
    <updated>2025-01-26T08:00:29.760Z</updated>
    
    <content type="html"><![CDATA[<figure><img data-src="https://githubimages.pengfeima.cn/images/202306140852343.jpg"alt="朱雀森林公园" /><figcaption aria-hidden="true">朱雀森林公园</figcaption></figure><!-- <div class="group-picture"><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306140852343.jpg"alt="朱雀森林公园" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306140846013.jpeg"alt="石海" /></div><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306140844802.jpeg"alt="冰晶顶" /></div></div><div class="group-picture-row"><div class="group-picture-column"><img data-src="https://githubimages.pengfeima.cn/images/202306140848507.jpeg"alt="山顶上的蓝天白云" /></div></div></div><p>--&gt;</p><!-- <iframe src="//player.bilibili.com/player.html?aid=838345990&bvid=BV1hg4y1i7tL&cid=194768979&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe> --><p>西安已经阴雨绵绵了半个月之久，六月十号是第一个放晴的周末。我和教研室的师弟师妹们总共六个人一起去朱雀森林公园爬山，最后登顶冰晶顶。当然，王璇也一起去了！🥰</p><span id="more"></span><p>冰晶顶旁边是一片松林，一棵棵松树就像一把把大伞，树下空间很大，我坐在里面给WX梳头。往常我会把头发一绺一绺地梳到手里，然后一把握住，绑个马尾，但是我觉得不绑头发更好看，于是我又把头发梳开，我们一边梳头一边自拍，以蓝天白云松林为背景。</p><figure><img data-src="https://githubimages.pengfeima.cn/images/202306140846013.jpeg"alt="石海" /><figcaption aria-hidden="true">石海</figcaption></figure><p>后来下山的时候又经过石海。石海像是鹅卵石铺成的，只不过是放大了几百倍的鹅卵石，那些石头小的也有半米高，表面光秃秃的，得手脚并用才能爬下去。王璇说我走得不稳，叫我小心点，走后面，慢慢走。可我走起来并没有觉得难，弯着腰爬实在太累，我就直起身子，在石头表面走，也挺稳的，走到边缘处，便从一块石头跳到另一块石头。</p><p>走着走着，WX很快就落在了后面，我回过头去，看见她正在为如何下山发愁，我就来到了她身边。</p><p>"不用管我，你自己先下去吧。" "别碰我，待会儿咱们两个人都摔了。"</p><p>我没有碰她，走在了她前面带路，不再在石头上乱跑。走出石海，到台阶上，我抱了抱她，她埋怨了几句，前面有个人都手臂擦伤了，你还乱跑。</p><p>到了草甸，我们坐了下来。周围人很多，很热闹，我们靠坐在一起，摆了摆姿势，变着花样自拍。风很大，她发丝飞扬。蓝天白云，阳光明媚，草地就像波光粼粼的湖面。</p><figure><img data-src="https://githubimages.pengfeima.cn/images/202306140844802.jpeg"alt="冰晶顶" /><figcaption aria-hidden="true">冰晶顶</figcaption></figure><figure><img data-src="https://githubimages.pengfeima.cn/images/202306140848507.jpeg"alt="山顶上的蓝天白云" /><figcaption aria-hidden="true">山顶上的蓝天白云</figcaption></figure>]]></content>
    
    
    <summary type="html">&lt;figure&gt;
&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306140852343.jpg&quot;
alt=&quot;朱雀森林公园&quot; /&gt;
&lt;figcaption aria-hidden=&quot;true&quot;&gt;朱雀森林公园&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;!-- &lt;div class=&quot;group-picture&quot;&gt;&lt;div class=&quot;group-picture-row&quot;&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306140852343.jpg&quot;
alt=&quot;朱雀森林公园&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306140846013.jpeg&quot;
alt=&quot;石海&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306140844802.jpeg&quot;
alt=&quot;冰晶顶&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;group-picture-row&quot;&gt;&lt;div class=&quot;group-picture-column&quot;&gt;&lt;img data-src=&quot;https://githubimages.pengfeima.cn/images/202306140848507.jpeg&quot;
alt=&quot;山顶上的蓝天白云&quot; /&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;--&amp;gt;&lt;/p&gt;
&lt;!-- &lt;iframe src=&quot;//player.bilibili.com/player.html?aid=838345990&amp;bvid=BV1hg4y1i7tL&amp;cid=194768979&amp;page=1&quot; scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;&gt; &lt;/iframe&gt; --&gt;
&lt;p&gt;西安已经阴雨绵绵了半个月之久，六月十号是第一个放晴的周末。我和教研室的师弟师妹们总共六个人一起去朱雀森林公园爬山，最后登顶冰晶顶。当然，王璇也一起去了！🥰&lt;/p&gt;</summary>
    
    
    
    <category term="生活" scheme="https://www.pengfeima.cn/categories/life/"/>
    
    
    <category term="爬山" scheme="https://www.pengfeima.cn/tags/%E7%88%AC%E5%B1%B1/"/>
    
  </entry>
  
  <entry>
    <title>2023年3月下旬</title>
    <link href="https://www.pengfeima.cn/posts/60751/"/>
    <id>https://www.pengfeima.cn/posts/60751/</id>
    <published>2023-03-21T16:00:00.000Z</published>
    <updated>2025-01-26T08:00:29.760Z</updated>
    
    <content type="html"><![CDATA[<div id="empty"></div><span id="more"></span><h2 id="月22日220158-todo">03月22日22:01:58 TODO</h2><h3 id="中期报告中的算例">1. 中期报告中的算例</h3><p>总共有五个算例，先解决三个： #### 1.1. 方腔驱动圆球的速度边界条件</p><h3 id="多重网格求解器的边界条件">2. 多重网格求解器的边界条件</h3><h3 id="半拉格朗日方法实现对流项">3. 半拉格朗日方法实现对流项</h3><h3 id="带有源项的连续性方程">4. 带有源项的连续性方程</h3><h3 id="docker实现项目的部署">5. docker实现项目的部署</h3><h2 id="月23日152141">03月23日15:21:41</h2><h3 id="需要修改多重网格方法的接口">需要修改多重网格方法的接口</h3><h3 id="一维多重网格方法">15:48:32 一维多重网格方法</h3><ol type="1"><li><p>零Dirichlet边界条件表现得很好。 commit:03c900305a40cab2c6207ce045ab8a8445ccf335 <img data-src="https://githubimages.pengfeima.cn/images/202303231550672.png" /></p></li><li><p>非零Dirichlet边界条件只需要给初值精确施加边界条件，也表现得很好。commit: 2d94d0dd677a9da65506f329893ac6d964941e87</p></li></ol><p><img data-src="https://githubimages.pengfeima.cn/images/202303231635219.png" /> 3.更改限制算子后发现影响不大。 <img data-src="https://githubimages.pengfeima.cn/images/202303231643029.png" />### 19:22:25 一维多重网格方法 Neumann 边界条件 commit:4320082a229e382218260d84280772cbb20a0add ### 19:45:47 二维多重网格方法Dirichlet 边界条件 commit: d7c7e58f1639f28bdd21df5ec4803c35c960d9c4</p><p><img data-src="https://githubimages.pengfeima.cn/images/202303231945600.png" /></p><h3 id="三维多重网格方法-dirichlet边界条件">23:02:59 三维多重网格方法Dirichlet边界条件</h3><p>commit: ba699c8e4d3d484fe3610b5c37d64a2c8f942a68 <img data-src="https://githubimages.pengfeima.cn/images/202303232304730.png"alt="image-20230323230419621" /></p><h2 id="年03月24日184911">2023年03月24日18:49:11</h2><p>commit: 0c19257a4cb08f344e97bf60173dc41948b7811d纯NEUMANN边界的三维Poisson问题收敛效果不佳 <img data-src="https://githubimages.pengfeima.cn/images/202303241850376.png" /></p><h2 id="月27日111856">03月27日11:18:56</h2><p>泊松求解器现在存在的问题： 1.带有Neumann边界的三维Poisson问题不收敛。当网格增加到129x129x129时，多重网格迭代不收敛。2.收敛速度慢。但是我看到一个别人写的，二维度Neumann问题，我觉得可能收敛。</p><h2 id="月29日095428-重大突破">03月29日09:54:28<strong>重大突破</strong></h2><p> 多重网格算法调通了，Neumann边界条件和Dirichlet边界条件都能快速收敛，边界可以是混合边界条件。TODO: 我需要写一个函数，遍历所有NEUMANN点。将的值赋予给额外点</p><h3 id="多重网格方法求解poisson方程的gpu加速">15:28:35多重网格方法求解Poisson方程的GPU加速</h3><p>测试的 CPU 为 Intel(R) Xeon(R) Gold 6240 CPU @ 2.60GHz，GPU为 NVIDIATesla V100 16GB ，网格单元数量为 <spanclass="math inline">\(256^3\)</span> 未知量个数为 <spanclass="math inline">\(3 \times 257^3\)</span> 。多重网格中最粗的网格为9x9x9，迭代格式采用了红黑高斯塞德尔迭代，限制算子类型为half-weighted，延拓算子类型为trilinear。平均单次V-cycle的单核CPU计算时间为110.189秒，GPU计算时间为0.049秒，加速比约为2250，达到了明显的加速效果。</p>]]></content>
    
    
    <summary type="html">&lt;div id=&quot;empty&quot;&gt;

&lt;/div&gt;</summary>
    
    
    
    <category term="科研" scheme="https://www.pengfeima.cn/categories/research/"/>
    
    
  </entry>
  
  <entry>
    <title>2023年3月上旬</title>
    <link href="https://www.pengfeima.cn/posts/32353/"/>
    <id>https://www.pengfeima.cn/posts/32353/</id>
    <published>2023-03-14T16:00:00.000Z</published>
    <updated>2025-01-26T08:00:29.760Z</updated>
    
    <content type="html"><![CDATA[<div id="empty"></div><span id="more"></span><h2 id="section">2023-03-01 10:01</h2><p>开始写论文的引言</p><h2 id="section-1">2023-03-01 11:30</h2><p>吃饭</p><h2 id="section-2">2023-03-01 14:42</h2><p>继续写引言</p><h2 id="section-3">2023-03-02 10:22</h2><p>继续写引言</p><h2 id="section-4">2023-03-06 20:48:06</h2><ol type="1"><li>回忆了一下怎么使用我的程序。 <pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> build <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> build <span class="token operator">&amp;&amp;</span> cmake <span class="token punctuation">..</span><span class="token function">make</span> <span class="token parameter variable">-j32</span></code></pre></li></ol><h2 id="section-5">2023-03-06 22:37:24</h2><ul><li>成功测试发送邮件功能</li></ul><h2 id="section-6">2023-03-07 00:12:17</h2><ul><li>成功测试计时功能</li></ul><h2 id="section-7">2023-03-07 10:53:07</h2><ul><li>测试插值算子和延拓算子. 程序为<code>test/test_ibm_elerian_larangian_interaction.cpp</code> ,测试通过。 考虑到计算效率, 目前固体只使用一阶有限元方法求解。</li></ul><h2 id="section-8">2023-03-07 16:00:50</h2><ul><li>显式浸没边界法, 程序为<code>test_ibm_disk_driven_explicit.cpp</code></li></ul><p>使用 ImersedBoundaryMethod 类 set_dolfin_solver</p><h2 id="section-9">2023-03-07 18:02:31</h2><p>test_ibm_disk_driven_explicit.cpp 能够运行了,但是流体的边界条件还不知道怎么设置。</p><p>可能需要在CPU中设置, 然后传输到GPU中。</p><h2 id="section-10">2023-03-08 10:09:21</h2><p>对于直杆弯曲问题, 固定边界有两种方式： 1. 通过Dirichlet条件限制 2.通过惩罚项约束</p><p>先实现第一种方法的显式时间离散。</p><p>现在, test_ibm_bended_bar_explicit_constraint.cpp 能够运行了。</p><h2 id="section-11">2023-03-08 10:28:36</h2><p>现在体积力的计算没问题了。</p><p>代码位置: 06b5d561eee0c173c3b65442c6d4ef7cfa3d29c3 边界标记:https://github.com/shaoyaoqian/shaoyaoqian.github.io/releases/download/##20230221/boundaries## 20230308112542.vtu 体积力:https://github.com/shaoyaoqian/shaoyaoqian.github.io/releases/download/##20230221/forces## 20230308112803.vtu</p><p>体积力的图片： <img data-src="https://githubimages.pengfeima.cn/images/202303081109425.png"alt="image-20230308110958262" /> <img data-src="https://githubimages.pengfeima.cn/images/202303081110614.png"alt="image-20230308111008591" /> <img data-src="https://githubimages.pengfeima.cn/images/202303081110118.png"alt="image-20230308111015098" /></p><h2 id="section-12">2023-03-08 14:58:31</h2><p>弯曲直杆问题的显式计算程序<code>test_ibm_bended_bar_explicit_constraint.cpp</code> 。</p><ol type="1"><li>测试限制条件。</li></ol><p>固体类需要有一个函数, 修改传入的位移或者速度。 GenericSolidSolver对象几乎是一个无状态的对象, 它不存储当前位置或者初始位置。真正的数据都存储在 <code>solid_mesh</code> 对象中,名为<code>_solid_positions</code> ,可以间接通过ImmersedBoundaryMethod获取。</p><h2 id="section-13">2023-03-08 21:12:57</h2><h3 id="程序框架的改进">程序框架的改进</h3><p>固体求解器不存储以下变量： 1. 固体的当前位置 2. 固体的体积力固体求解器根据传入的固体的当前位置计算出固体的体积力。但是会存储一些与模型相关的数据，例如：1. 边界条件存储在boundaries变量中 2. 当前时刻和时间步长 3.其他与模型相关的变量，例如本构参数，电势等等。</p><p>ImmersedBoundaryMethod 中更新 solid solver位置的函数也不再有用，因此一并删去。</p><p>ImmersedBoundaryMethod 增加了限制固体位移的函数。</p><h2 id="section-14">2023-03-08 21:30:07</h2><h3 id="写论文的引言">写论文的引言</h3><h2 id="section-15">2023-03-09 10:00:34</h2><h3 id="完成了引言的参考文献">完成了引言的参考文献</h3><h2 id="section-16">2023-03-09 11:07:06</h2><h3 id="测试">测试</h3><p>带约束条件的直杆弯曲算例<code>test_ibm_bended_bar_explicit_constraint.cpp</code> 的运行结果</p><h4 id="参数">参数：</h4><ol type="1"><li>固体网格的坐标 (0.45, 0.45, 0.1) (0.55, 0.55, 0.9)</li><li>网格剖分 {4, 4, 32};</li><li>流体粘性、密度、时间步长： double nu = 0.01; double rho = 1.0;double dt = 0.0001;</li><li>背景网格 int3 dim_bg = {65, 65, 65}; double3 dh_bg = {0.0, 0.0,0.0}; double3 box_size_bg = {1.0, 1.0, 1.0};</li></ol><p>不稳定，可以看到<code>t=0.298</code>时刻的运行结果： <img data-src="https://githubimages.pengfeima.cn/images/202303091108961.png"alt="弯曲直杆问题的运行结果" /></p><h4 id="计算结果">计算结果</h4><p>https://github.com/shaoyaoqian/shaoyaoqian.github.io/releases/download/20230221/bended_bar_020230309111559.vtu</p><h2 id="section-17">2023-03-09 11:39:40</h2><h3 id="应变能函数中加入不可压项">应变能函数中加入不可压项</h3><pre class="language-python" data-language="python"><code class="language-python">kappa <span class="token operator">=</span> <span class="token number">100000.0</span>J <span class="token operator">=</span> det<span class="token punctuation">(</span>F<span class="token punctuation">)</span>kappa <span class="token operator">*</span> <span class="token punctuation">(</span>J<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token operator">*</span>ln<span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="section-18">2023-03-09 17:05:14</h2><p>加入了不可压项，时间步长仍为<spanclass="math inline">\(0.0001\)</span>，仍旧不稳定，这在预料之中。</p><h3 id="代码位置">代码位置</h3><p>451c31458906e2d2c158fc404c4824418cb3067e ### 结果 <img data-src="https://githubimages.pengfeima.cn/images/202303091708783.png"alt="t=0.0298" /></p><h3 id="问题">问题</h3><ol type="1"><li>边界条件可能没有在计算固体的体积力前施加</li><li>不可压边界条件不起作用</li></ol><h2 id="section-19">2023-03-09 20:11:49</h2><h3 id="问题一不可压条件">问题一：不可压条件</h3><p>固体的不可压条件可以通过两种方法施加，第一种是拉格朗日乘子法，另一种是通过惩罚项强制<spanclass="math inline">\(\text{det}(\mathbb{F})=1\)</span>满足。一般来说，只要选取其中一种即可。浸没边界法中，不可压条件自然存在。整个计算区域的速度场满足无散度条件，相当于使用了拉格朗日乘子法。但是速度经过插值算子传递到固体区域后，无散度边界条件可能不精确满足，因此需要对固体额外施加不可压条件。以后可以看看文章<code>A monolithic projection framework for constrained FSI problems with the immersed boundary method</code>是怎么施加约束条件的。</p><h3id="问题二固体位移的dirichlet边界条件">问题二：固体位移的Dirichlet边界条件</h3><p>有两种方法。第一种是每个时间步后将固体强制拉回原位，第二种是惩罚项。目前发现第一种方法不行。张心欣是用的第一种方法，可能是因为它使用的固体本构简单吧，所以他的没问题。IBAMR一直使用的是第二种方法。</p><h2 id="section-20">2023-03-10 09:25:49</h2><h3 id="计划">计划</h3><ol type="1"><li>符号表</li><li>完成浸没有限元方法的数学描述</li></ol><h2 id="查看结果">2023-03-10 10:08:57 查看结果</h2><h3 id="代码位置-1">代码位置</h3><p>168394afa3200c5016eadc8bbfdf21b2b5b2d4cd</p><h3 id="参数-1">参数</h3><pre class="language-c++" data-language="c++"><code class="language-c++">int3 dim &#x3D; &#123;4, 4, 32&#125;;dolfin::Point p2(0.45, 0.45, 0.1);dolfin::Point p3(0.55, 0.55, 0.9);double nu &#x3D; 0.01;double rho &#x3D; 1.0;double dt &#x3D; 0.00001;int3 dim_bg &#x3D; &#123;65, 65, 65&#125;;double3 dh_bg &#x3D; &#123;0.0, 0.0, 0.0&#125;;double3 box_size_bg &#x3D; &#123;1.0, 1.0, 1.0&#125;;</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># Constituitive parameters</span>C <span class="token operator">=</span> <span class="token number">20000.0</span>  <span class="token comment"># dyn/cm^2 (2kPa)</span>bf <span class="token operator">=</span> <span class="token number">8.0</span>bt <span class="token operator">=</span> <span class="token number">2.0</span>bfs <span class="token operator">=</span> <span class="token number">4.0</span>kappa <span class="token operator">=</span> <span class="token number">1e4</span> <span class="token comment"># Penalty for incompressibility</span>beta <span class="token operator">=</span> <span class="token number">1e4</span>  <span class="token comment"># Penalty for boundary conditions</span><span class="token comment"># Boundary markers</span>bottom   <span class="token operator">=</span> <span class="token number">2</span>fixed    <span class="token operator">=</span> <span class="token number">1</span><span class="token comment"># Pressure</span>pressure <span class="token operator">=</span> <span class="token number">40</span></code></pre><h3 id="结果">结果</h3><figure><img data-src="https://githubimages.pengfeima.cn/images/202303101008811.png"alt="image-20230310100836714" /><figcaption aria-hidden="true">image-20230310100836714</figcaption></figure><h3 id="数据">数据</h3><p>https://github.com/shaoyaoqian/shaoyaoqian.github.io/releases/download/20230221/position00019920230310101333.vtu</p><h3 id="问题-1">问题</h3><ol type="1"><li>惩罚项不够大</li><li>直杆没有向正上方偏移</li></ol><h2 id="符号表">2023-03-10 10:23:34 符号表</h2><p>以下是本论文中使用的符号的非详尽列表。我们将采用粗体字符表示矢量的惯例。</p><h3 id="欧拉描述">欧拉描述</h3><table><colgroup><col style="width: 27%" /><col style="width: 60%" /><col style="width: 12%" /></colgroup><thead><tr class="header"><th style="text-align: left;"></th><th style="text-align: left;">Explanation</th><th style="text-align: left;">中文解释</th></tr></thead><tbody><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\Omega\)</span></td><td style="text-align: left;">An open subset of <spanclass="math inline">\(\mathbb{R}^n\)</span></td><td style="text-align: left;">背景区域</td></tr><tr class="even"><td style="text-align: left;"><span class="math inline">\(\partial\Omega\)</span></td><td style="text-align: left;">boundary of <spanclass="math inline">\(\Omega\)</span></td><td style="text-align: left;">区域边界</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\mathbf{u}\)</span></td><td style="text-align: left;">Velocity field</td><td style="text-align: left;">速度场</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(p\)</span></td><td style="text-align: left;">Pressure field</td><td style="text-align: left;">压强场</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\mathbf{n}\)</span></td><td style="text-align: left;">Unit vector normal to <spanclass="math inline">\(\partial \Omega\)</span></td><td style="text-align: left;">单位外法向</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(\nabla\cdot\mathbf{u}\)</span></td><td style="text-align: left;">Divergence of <spanclass="math inline">\(\mathbf{u}\)</span></td><td style="text-align: left;">速度散度</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\nabla\mathbf{u}\)</span></td><td style="text-align: left;">Gradient of <spanclass="math inline">\(\mathbf{u}\)</span></td><td style="text-align: left;">速度梯度</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(\Delta\mathbf{u}\)</span></td><td style="text-align: left;">Laplacian of u, defined by <spanclass="math inline">\(\Delta=\nabla\cdot\nabla\)</span></td><td style="text-align: left;">拉普拉斯算子</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\langle\cdot,\cdot\rangle\)</span></td><td style="text-align: left;"><spanclass="math inline">\(L^2\)</span>-inner product on <spanclass="math inline">\(\Omega\)</span></td><td style="text-align: left;"><spanclass="math inline">\(L^2\)</span>内积</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(\|\cdot\|_k\)</span></td><td style="text-align: left;">Norm defined by the <spanclass="math inline">\(H^k\)</span>-inner product on <spanclass="math inline">\(\Omega\)</span> if <span class="math inline">\(k =0, 1\)</span></td><td style="text-align: left;"><spanclass="math inline">\(H^{k}\)</span>范数</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\|\cdot\|_2\)</span></td><td style="text-align: left;">Euclidian norm</td><td style="text-align: left;">欧几里得范数</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(\mathbf{x}\)</span></td><td style="text-align: left;"><spanclass="math inline">\(\mathbf{x}=(x_1,x_2,x_3)\)</span> Euleriancoordinates</td><td style="text-align: left;">欧拉坐标</td></tr></tbody></table><h3 id="拉格朗日描述">拉格朗日描述</h3><h3 id="参数-2">参数</h3><table><colgroup><col style="width: 15%" /><col style="width: 66%" /><col style="width: 18%" /></colgroup><thead><tr class="header"><th style="text-align: left;"></th><th style="text-align: left;">Explanation</th><th style="text-align: left;">中文解释</th></tr></thead><tbody><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\mu\)</span></td><td style="text-align: left;">(Dynamic) Viscosity</td><td style="text-align: left;">动力粘性</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(\rho\)</span></td><td style="text-align: left;">Density</td><td style="text-align: left;">密度</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(\nu\)</span></td><td style="text-align: left;">Kinematic viscosity, defined asnu:=mu//rho</td><td style="text-align: left;">运动粘性</td></tr><tr class="even"><td style="text-align: left;"><span class="math inline">\(\Deltat\)</span></td><td style="text-align: left;">Timestep</td><td style="text-align: left;">时间步长</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(Re\)</span></td><td style="text-align: left;">Reynolds number</td><td style="text-align: left;">雷诺数</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(h\)</span></td><td style="text-align: left;">Discretization parameter<a href="#fn1"class="footnote-ref" id="fnref1"role="doc-noteref"><sup>1</sup></a></td><td style="text-align: left;">空间离散参数</td></tr></tbody></table><h3 id="矩阵的性质">矩阵的性质</h3><table><colgroup><col style="width: 15%" /><col style="width: 60%" /><col style="width: 24%" /></colgroup><thead><tr class="header"><th style="text-align: left;"></th><th style="text-align: left;">Explanation</th><th style="text-align: left;">中文解释</th></tr></thead><tbody><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(L^2(\Omega)\)</span></td><td style="text-align: left;">Space of square-integrable functions on<span class="math inline">\(\Omega\)</span></td><td style="text-align: left;"><spanclass="math inline">\(\Omega\)</span>上的平方可积函数</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(H^k(\Omega)\)</span></td><td style="text-align: left;">Space of <spanclass="math inline">\(L^2\)</span>-functions on <spanclass="math inline">\(\Omega\)</span> with derivatives up to order <spanclass="math inline">\(k\)</span> which are also in <spanclass="math inline">\(L^2(\Omega)\)</span></td><td style="text-align: left;"><spanclass="math inline">\(H^{k}\)</span>空间</td></tr><tr class="odd"><td style="text-align: left;"><spanclass="math inline">\(H_0^k(\Omega)\)</span></td><td style="text-align: left;">Space of functions in <spanclass="math inline">\(H^k(\Omega)\)</span> which equal zero on <spanclass="math inline">\(\partial \Omega\)</span></td><td style="text-align: left;"><spanclass="math inline">\(H^1\)</span>空间</td></tr><tr class="even"><td style="text-align: left;"><spanclass="math inline">\(H^{-1}\)</span></td><td style="text-align: left;">Dual space of <spanclass="math inline">\(H^1\)</span></td><td style="text-align: left;"><spanclass="math inline">\(H^1\)</span>的对偶空间</td></tr></tbody></table><h3 id="固体力学">固体力学</h3><table><colgroup><col style="width: 20%" /><col style="width: 61%" /><col style="width: 18%" /></colgroup><thead><tr class="header"><th></th><th>Explanation</th><th style="text-align: left;">中文解释</th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(\boldsymbol \sigma\)</span></td><td>The Cauchy stress tensor</td><td style="text-align: left;">柯西应力张量</td></tr><tr class="even"><td><span class="math inline">\(\mathbb{P}\)</span></td><td>the first Piola–Kirchhoff stress tensor</td><td style="text-align: left;">第一PK应力张量</td></tr><tr class="odd"><td><span class="math inline">\(W\)</span></td><td>Strain energy density function</td><td style="text-align: left;">应变能密度函数</td></tr><tr class="even"><td><span class="math inline">\(E\)</span></td><td>Elastic potential energy function</td><td style="text-align: left;">弹性势能函数</td></tr><tr class="odd"><td><span class="math inline">\(?\)</span></td><td>Kinetic energy function</td><td style="text-align: left;">动能函数</td></tr><tr class="even"><td><span class="math inline">\(B\)</span></td><td>A region in three-dimensional Euclidean point space(<spanclass="math inline">\(\mathbb{R}^n\)</span>), called configuration of<span class="math inline">\(\mathcal{B}\)</span></td><td style="text-align: left;">固体的构型</td></tr><tr class="odd"><td><span class="math inline">\(B_r\)</span></td><td>A specific configuration of <spanclass="math inline">\(\mathcal{B}\)</span></td><td style="text-align: left;">参考构型</td></tr><tr class="even"><td><span class="math inline">\(B_t\)</span></td><td>Current configutation of <spanclass="math inline">\(\mathcal{B}\)</span></td><td style="text-align: left;">现时构型，当前构型</td></tr><tr class="odd"><td><span class="math inline">\(\mathcal{B}\)</span></td><td>A body, considered as a set of elements, or particles, or materialpoints, whatever</td><td style="text-align: left;">固体</td></tr></tbody></table><table><colgroup><col style="width: 24%" /><col style="width: 54%" /><col style="width: 21%" /></colgroup><thead><tr class="header"><th><span class="math inline">\(\mathcal{X}(\mathbf{X},t)\)</span></th><th>bijection mapping between <span class="math inline">\(B_r\)</span>and <span class="math inline">\(B_t\)</span></th><th></th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(\mathbf{X}\)</span></td><td><spanclass="math inline">\(\mathbf{X}=(X_1,X_2,X_3)\)</span>Coordinates ofmaterial points at reference configuration</td><td>固体粒子在参考构型的坐标</td></tr><tr class="even"><td>t</td><td>current time</td><td>当前时间</td></tr><tr class="odd"><td><span class="math inline">\(T\)</span></td><td>total time interval</td><td>时间间隔</td></tr></tbody></table><h3 id="浸没边界法">浸没边界法</h3><table><colgroup><col style="width: 40%" /><col style="width: 50%" /><col style="width: 8%" /></colgroup><tbody><tr class="odd"><td><span class="math inline">\(\mathcal{S}(\mathbf{X},t)\)</span></td><td>prolongation operation, distribution operator</td><td>延拓算子</td></tr><tr class="even"><td><spanclass="math inline">\(\mathcal{J}(\mathbf{\mathbf{X}},t)\)</span></td><td>restriction operator, interpolation operator</td><td>插值算子</td></tr><tr class="odd"><td></td><td></td><td></td></tr></tbody></table><h2 id="完成文章的第二章">2023-03-10 16:40:37 完成文章的第二章</h2><p>图1描述了一物体<spanclass="math inline">\(\mathcal{B}\)</span>在固定的背景区域<spanclass="math inline">\(\Omega\)</span>中运动的过程。 物体 <spanclass="math inline">\(\mathcal{B}\)</span>所有质点空间坐标的集合称为其构型，记为<spanclass="math inline">\(B\)</span>。<spanclass="math inline">\(t\in[0,T]\)</span> 表示时间，<spanclass="math inline">\(B_t\)</span> 表示固体 <spanclass="math inline">\(\mathcal{B}\)</span> 在 <spanclass="math inline">\(t\)</span>时刻的构型，称为现时构型。对任意时间<spanclass="math inline">\(t\)</span>，有唯一的构型<spanclass="math inline">\(B_t\)</span>与之对应，这些构型的集合<spanclass="math inline">\(\{B_t\}\)</span>称为物体<spanclass="math inline">\(\mathcal{B}\)</span>在时间<spanclass="math inline">\([0,T]\)</span>的运动。<spanclass="math inline">\(\mathcal{B}_r\)</span>表示固体在<spanclass="math inline">\(t=0\)</span>时刻的构型，称为参考构型。<spanclass="math inline">\(\mathbf{X}\)</span>表示物体<spanclass="math inline">\(\mathcal{B}\)</span>任一质点在参考构型中的空间坐标，<spanclass="math inline">\(\mathbf{X}=\)</span> <spanclass="math inline">\(\left(X_{1}, X_{2}, \ldots\right)\in B_{r} \subset\mathbb{R}^{d}, d=2,3\)</span> ，称之为拉格朗日坐标。<spanclass="math inline">\(\mathcal{X}(\mathbf{X},t)\)</span>是从<spanclass="math inline">\(B_r\)</span>到<spanclass="math inline">\(B_t\)</span>的映射，映射<spanclass="math inline">\(\mathcal{X}(\mathbf{X},t)\)</span>称为固体从<spanclass="math inline">\(\mathcal{B}_r\)</span>到<spanclass="math inline">\(\mathcal{B}_t\)</span>的形变。<spanclass="math inline">\(\mathcal{X}(\mathbf{X},t)\)</span>是定义在参考构型 <span class="math inline">\(B_r\)</span>上的物理量，以<spanclass="math inline">\(\mathbf{X}\)</span>为自变量，我们称之为拉格朗日描述。区域<spanclass="math inline">\(\Omega\)</span>表示流固耦合系统占据的物理区域，<spanclass="math inline">\(\Omega/B_t\)</span>为流体区域，我们讨论定义在<spanclass="math inline">\(\Omega\)</span>上的方程，不对流体区域进行单独描述。<spanclass="math inline">\(\mathbf{x}\)</span>表示<spanclass="math inline">\(\Omega\)</span>中的任意一点，<spanclass="math inline">\(\mathbf{x}=\left(x_{1}, x_{2} \ldots\right)\in\Omega \subset \mathbb{R}^{d}, d=2,3\)</span>，称之为欧拉坐标。<spanclass="math inline">\(\mathbf{u}(\mathbf{x},t)\)</span>、<spanclass="math inline">\(p(\mathbf{x},t)\)</span>分别表示流固耦合系统的速度场和压力场。</p><p>Figure 1 describes the motion of an body <spanclass="math inline">\(\mathcal{B}\)</span> in a fixed background domain<span class="math inline">\(\Omega\)</span>. The set of spatialcoordinates of all particles of body <spanclass="math inline">\(\mathcal{B}\)</span> is called its configuration,denoted by <span class="math inline">\(B\)</span>. <spanclass="math inline">\(t\in[0,T]\)</span> represents time, <spanclass="math inline">\(B_t\)</span> represents the configuration of body<span class="math inline">\(\mathcal{B}\)</span> at time <spanclass="math inline">\(t\)</span>, which is called the currentconfiguration. For any time <span class="math inline">\(t\)</span>,there is a unique configuration <span class="math inline">\(B_t\)</span>corresponding to it. The set of these configurations <spanclass="math inline">\({B_t}\)</span> is called the motion of body <spanclass="math inline">\(\mathcal{B}\)</span> during time <spanclass="math inline">\([0,T]\)</span>. <spanclass="math inline">\(B_r\)</span> denotes the configuration of the bodyat <span class="math inline">\(t=0\)</span>, called the referenceconfiguration. <span class="math inline">\(\mathbf{X}\)</span>represents the spatial coordinate of a specific particle in thereference configuration of body <spanclass="math inline">\(\mathcal{B}\)</span>, <spanclass="math inline">\(\mathbf{X}=\left(X_{1}, X_{2}, X_{3}\right)\inB_{r} \subset \mathbb{R}^{e}\)</span>, which is called the Lagrangiancoordinate. <spanclass="math inline">\(\mathcal{X}(\mathbf{X},t)\)</span> is the mappingfrom <span class="math inline">\(B_r\)</span> to <spanclass="math inline">\(B_t\)</span>, which is called the deformation ofthe body from <span class="math inline">\(B_r\)</span> to <spanclass="math inline">\(B_t\)</span>. <spanclass="math inline">\(\mathcal{X}(\mathbf{X},t)\)</span> is a physicalquantity defined on the reference configuration <spanclass="math inline">\(B_r\)</span>. We call it the Lagrangiandescription, with <span class="math inline">\(\mathbf{X}\)</span> as itsindependent variable. The domain <spanclass="math inline">\(\Omega\)</span> represents the physical domainoccupied by the fluid-solid coupling system. <spanclass="math inline">\(\Omega/B_t\)</span> denotes the fluid domain. Wediscuss equations defined on <span class="math inline">\(\Omega\)</span>and do not separately describe the fluid domain. <spanclass="math inline">\(\mathbf{x}\)</span> represents any point in <spanclass="math inline">\(\Omega\)</span>, <spanclass="math inline">\(\mathbf{x}=\left(x_{1}, x_{2}, x_{3}\right)\in\Omega \subset \mathbb{R}^{3}\)</span>, which is called the Euleriancoordinate.</p><p>假设固体和流体均不可压且密度相等，流体为牛顿流体，固体为粘超弹性固体，流固耦合系统的柯西应力张量为</p><p>Assuming that both the solid and fluid are incompressible and haveequal densities, the fluid is assumed to be a Newtonian fluid and thesolid is assumed to be a viscous hyperelastic material, then the Cauchystress tensor of the fluid-structure coupling system is given by <spanclass="math display">\[\boldsymbol{\sigma}(\mathbf{x},t)=\boldsymbol{\sigma}^{\mathrm{f}}(\mathbf{x}, t)+\begin{cases}\boldsymbol{\sigma}^{\mathrm{e}}(\mathbf{x}, t) &amp;\mathbf{x} \in B_t \\ \mathbf{0} &amp;\mathbf{x}\in\Omega/B_t\end{cases}\]</span> Here are the meanings of the quantities and variables thatappear in the above equations in details. <span class="math display">\[\boldsymbol{\sigma}^{\mathrm{f}}(\mathbf{x}, t)=-p(\mathbf{x}, t)\mathbb{I}+\mu\left[\nabla \mathbf{u}(\mathbf{x}, t)+(\nabla\mathbf{u}(\mathbf{x}, t))^{\mathrm{T}}\right]\]</span></p><p><span class="math display">\[\boldsymbol{\sigma}^{\mathrm{e}}(\mathbf{x},t)=\boldsymbol{\sigma}^{\mathrm{e}}(\boldsymbol{\mathcal{X}}(\mathbf{X},t), t)  = J^{-1}(\mathbf{X}, t)\mathbb{P}^{\mathrm{e}}(\mathbf{X},t)\mathbb{F}^{\mathrm{T}}(\mathbf{X}, t)\]</span></p><p><span class="math inline">\(\mathbb{I}\)</span>为单位张量，<spanclass="math inline">\(\mu\)</span>为运动粘性，<spanclass="math inline">\(\mathbb{F}(\mathbf{X},t)\)</span>为形变梯度，<spanclass="math inline">\(J(\mathbf{X},t)=\operatorname{det}(\mathbb{F}(\mathbf{X}, t))\)</span>，<spanclass="math inline">\(\mathbb{P}(\mathbf{X},t)\)</span>为第一Piola-Kirchhoff应力张量，可以通过对应变能函数<spanclass="math inline">\(W(\mathbb{F})\)</span>求导得到</p><p><spanclass="math inline">\(\boldsymbol{\sigma}^{\mathrm{f}}(\mathbf{x},t)\)</span> is the fluid-like component of stress tensor which exitseverywehre in <span class="math inline">\(\Omega\)</span>, <spanclass="math inline">\(\mathbf{u}(\mathbf{x},t)\)</span> and <spanclass="math inline">\(p(\mathbf{x},t)\)</span> represent the velocityfield and pressure field of the fluid-solid coupling system,respectively. <span class="math inline">\(\mathbb{I}\)</span> is theidentity tensor, <span class="math inline">\(\mu\)</span> is the dynamicviscosity. <spanclass="math inline">\(\boldsymbol{\sigma}^{\mathrm{f}}(\mathbf{x},t)\)</span> is the elastic component of stress tensor which only existsin solid domain. <spanclass="math inline">\(\mathbb{F}(\mathbf{X},t)\)</span> is thedeformation gradient, <span class="math inline">\(J(\mathbf{X},t)=\operatorname{det}(\mathbb{F}(\mathbf{X}, t))\)</span>, and <spanclass="math inline">\(\mathbb{P}(\mathbf{X},t)\)</span> is the firstPiola-Kirchhoff stress tensor, which can be obtained by taking thederivative of the corresponding strain energy function <spanclass="math inline">\(W(\mathbb{F})\)</span> <spanclass="math display">\[\mathbb{P}^{\mathrm{e}}=\frac{\partial W^{\mathrm{e}}}{\partial\mathbb{F}}\]</span>浸没边界法的控制方程可以通过动量守恒定律和质量守恒定律推导。在求解中，<spanclass="math inline">\(\boldsymbol{\sigma}^f(\mathbf{x},t)\)</span>需采用欧拉描述，<spanclass="math inline">\(\boldsymbol{\sigma}^{e}(\mathbf{x},t)\)</span>需采用拉格朗日描述，它们之间通过与delta核函数的积分变换建立起联系。本文采用了Boyce等人推导的方程组。</p><p>The governing equations of the Immersed Boundary Method can bederived from the principles of conservation of momentum and mass. Whenwe solve the problem practically, the fluid stress tensor <spanclass="math inline">\(\boldsymbol{\sigma}^f(\mathbf{x}, t)\)</span> isexpressed in Eulerian description, while the solid stress tensor <spanclass="math inline">\(\boldsymbol{\sigma}^{e}(\mathbf{x}, t)\)</span> isexpressed in Lagrangian description. The relationship between them isestablished through integration with the delta kernel function.Equations derived by Boyce et al. is adopted in this paper. <spanclass="math display">\[\rho(\frac{\partial \bf{u}}{\partial t}+(\bf{u}\cdot \nabla)\bf{u})+\nabla p -\mu \Delta \bf{u} = \bf{f}\]</span> <span class="math display">\[\nabla\cdot \bf{u} = 0\]</span> <span class="math display">\[\int_{\bf{B}_{r}}\bf{F}\cdot \bf{V}d\bf{X} =-\int_{\bf{B}_{r}}\mathbb{P}:\nabla \bf{V}d\bf{X}\]</span> <span class="math display">\[\bf{f}(x,t) = \int_{\bf{B}_{r}}\bf{F}(\bf{X},t)\delta(x-\chi(\bf{X},t)d\bf{X}\]</span> <span class="math display">\[\frac{\partial{\chi (\bf{X,t})}}{\partial t}=\int_{\Omega}\bf{u}(x,t)\delta (\chi (\bf{X},t)-x)dx\]</span></p><h2 id="多孔介质固体的流固耦合">2023-03-11 01:26:50多孔介质固体的流固耦合</h2><h3 id="灌注压力的求解">灌注压力的求解</h3><ul><li><span class="math inline">\(M_b\)</span>:常数</li><li><spanclass="math inline">\(p\)</span>：是灌注压力，和流体的压力无关</li><li><span class="math inline">\(f(J)=\frac{2(J(\mathbf{X}, t)-1-\ln(J(\mathbf{X}, t)))}{(J(\mathbf{X}, t)-1)^2}\)</span></li><li><span class="math inline">\(E(M,J)\)</span>:一个标量，与<spanclass="math inline">\(m^n\)</span>和<spanclass="math inline">\(J^n\)</span></li></ul><p><span class="math display">\[\frac{P^{n+\frac{1}{2}}-P^n}{\triangle t / 2}-M_b f\left(J^n\right)\nabla_{\mathbf{X}} \cdot\left(J^n \mathbb{F}^{-1} \mathbf{K}\mathbb{F}^{-T} \nabla P^{n+\frac{1}{2}}\right)=E\left(M^n, J^n\right)\]</span></p><p>在求解此方程之前，我们先考虑带矩阵系数的泊松方程。</p><h3 id="带矩阵系数的泊松方程">带矩阵系数的泊松方程</h3><p>带矩阵系数的泊松方程为： <span class="math display">\[-\nabla \cdot(\boldsymbol{A}\nabla u) = f\]</span> 其中，<span class="math inline">\(u\)</span>是未知函数，<spanclass="math inline">\(f\)</span>是已知函数，<spanclass="math inline">\(\boldsymbol{A}\)</span>是一个矩阵。其变分形式可以表示为：找到一个函数<spanclass="math inline">\(u \in H^1(\Omega)\)</span>，满足下列变分问题：</p><p><span class="math display">\[\int_{\Omega} \boldsymbol{A}\nabla u \cdot \nabla v \;dx =\int_{\partial \Omega} A\nabla u\cdot \mathbf{n} v \;ds+\int_{\Omega} fv\;dx \quad\forall \;v \in H^1(\Omega)\]</span></p><p>其中<span class="math inline">\(\Omega\)</span>是定义域，<spanclass="math inline">\(\partial \Omega\)</span>是<spanclass="math inline">\(\Omega\)</span>的边界。若<spanclass="math inline">\(g=A\nabla u\cdot\mathbf{n}\)</span>为已知函数，则能求解。</p><h2 id="section-21">2023-03-11 12:21:22</h2><h3 id="算例1立方体膨胀-swelling-for-a-cube">算例1：立方体膨胀 swellingfor a cube</h3><p>背景区域：区域为 <span class="math inline">\(1 \times 1 \times 1\mathrm{~cm}^3\)</span> ，网格剖分为 <span class="math inline">\(96\times 96 \times 96\)</span> 。</p><h4id="质疑背景区域和固体区域一样大么">质疑：背景区域和固体区域一样大么？</h4><p>固体的位移边界条件：<spanclass="math inline">\(x=0,y=0,z=0\)</span>三个平面的法向位移为零。</p><p>源项：<span class="math inline">\(S=0\)</span>。</p><p>灌注压力：</p><ul><li><spanclass="math inline">\(x=0\)</span>平面施加与时间相关的压力，<spanclass="math inline">\(p_{\mathrm{bc}}=10^3\left(1-\exp \left(-t^2 /0.25\right)\right)\)</span>。</li><li><span class="math inline">\(x=1\)</span>平面的压力恒为零。</li><li>其他平面为零Neumann边界条件。</li></ul><p>预期结果：</p><p>由于平面<span class="math inline">\(x=0\)</span>施加了空隙压力(porepressure)，立方体会像海绵一样膨胀。</p><figure><img data-src="https://githubimages.pengfeima.cn/images/202303111203631.jpg"alt="立方体膨胀" /><figcaption aria-hidden="true">立方体膨胀</figcaption></figure><h2 id="section-22">2023-03-11 12:21:44</h2><h3 id="代码位置-2">代码位置</h3><p>168394afa3200c5016eadc8bbfdf21b2b5b2d4cd</p><h3 id="参数-3">参数</h3><pre class="language-c++" data-language="c++"><code class="language-c++">int3 dim &#x3D; &#123;4, 4, 32&#125;;dolfin::Point p2(0.45, 0.45, 0.1);dolfin::Point p3(0.55, 0.55, 0.9);double nu &#x3D; 0.01;double rho &#x3D; 1.0;double dt &#x3D; 0.000005;int3 dim_bg &#x3D; &#123;65, 65, 65&#125;;double3 dh_bg &#x3D; &#123;0.0, 0.0, 0.0&#125;;double3 box_size_bg &#x3D; &#123;1.0, 1.0, 1.0&#125;;</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># Constituitive parameters</span>C <span class="token operator">=</span> <span class="token number">20000.0</span>  <span class="token comment"># dyn/cm^2 (2kPa)</span>bf <span class="token operator">=</span> <span class="token number">8.0</span>bt <span class="token operator">=</span> <span class="token number">2.0</span>bfs <span class="token operator">=</span> <span class="token number">4.0</span>kappa <span class="token operator">=</span> <span class="token number">1e1</span> <span class="token comment"># Penalty for incompressibility</span>beta <span class="token operator">=</span> <span class="token number">1e7</span>  <span class="token comment"># Penalty for boundary conditions</span><span class="token comment"># Boundary markers</span>bottom   <span class="token operator">=</span> <span class="token number">2</span>fixed    <span class="token operator">=</span> <span class="token number">1</span><span class="token comment"># Pressure</span>pressure <span class="token operator">=</span> <span class="token number">40</span></code></pre><h3 id="结果-1">结果</h3><figure><img data-src="https://githubimages.pengfeima.cn/images/202303111224740.png"alt="t=170*0.000005" /><figcaption aria-hidden="true">t=170*0.000005</figcaption></figure><h3 id="数据-1">数据</h3><p>https://github.com/shaoyaoqian/shaoyaoqian.github.io/releases/download/20230221/position00017020230311122948.vtu</p><h3 id="问题-2">问题</h3><ol type="1"><li>直杆没有向正上方偏移</li><li>参数kappa过大是否会导致直杆不会弯曲</li></ol><aside id="footnotes" class="footnotes footnotes-end-of-document"role="doc-endnotes"><hr /><ol><li id="fn1"><p>Discretization parameter, proportional to the length ofthe longest edge of an element in a partition of <spanclass="math inline">\(\Omega\)</span><a href="#fnref1"class="footnote-back" role="doc-backlink">↩︎</a></p></li></ol></aside>]]></content>
    
    
    <summary type="html">&lt;div id=&quot;empty&quot;&gt;

&lt;/div&gt;</summary>
    
    
    
    <category term="科研" scheme="https://www.pengfeima.cn/categories/research/"/>
    
    
  </entry>
  
</feed>
